import{r as Ns,a as Es}from"./vendor-CSDcbZvL.js";import{r as y,L as W,N as Rs,u as Ts,a as Ps,B as Is,R as yt,b as ee,c as wt}from"./router-Jbp2AjJs.js";import{S as Wt,M as Jt,B as As,X as _e,a as $s,H as Os,U as Vt,b as Ne,c as ce,d as He,C as Kt,e as Ds,f as Us,g as Fs,h as Xt,F as Yt,A as dt,i as $e,j as _t,E as Ms,k as Ls,l as qs}from"./icons-CT_-nTgo.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function t(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(o){if(o.ep)return;o.ep=!0;const i=t(o);fetch(o.href,i)}})();var Ze={exports:{}},Se={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vt;function Bs(){if(vt)return Se;vt=1;var s=Ns(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,o=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function a(c,l,d){var u,b={},N=null,k=null;d!==void 0&&(N=""+d),l.key!==void 0&&(N=""+l.key),l.ref!==void 0&&(k=l.ref);for(u in l)r.call(l,u)&&!i.hasOwnProperty(u)&&(b[u]=l[u]);if(c&&c.defaultProps)for(u in l=c.defaultProps,l)b[u]===void 0&&(b[u]=l[u]);return{$$typeof:e,type:c,key:N,ref:k,props:b,_owner:o.current}}return Se.Fragment=t,Se.jsx=a,Se.jsxs=a,Se}var Ct;function Hs(){return Ct||(Ct=1,Ze.exports=Bs()),Ze.exports}var n=Hs(),Oe={},St;function zs(){if(St)return Oe;St=1;var s=Es();return Oe.createRoot=s.createRoot,Oe.hydrateRoot=s.hydrateRoot,Oe}var Ws=zs();const Gt=y.createContext(void 0),Js=({children:s})=>{const[e,t]=y.useState("light"),[r,o]=y.useState(!1);y.useEffect(()=>{const a=localStorage.getItem("theme");(a==="dark"||a==="light")&&t(a),o(!0)},[]),y.useEffect(()=>{r&&(localStorage.setItem("theme",e),document.documentElement.classList.remove("light","dark"),document.documentElement.classList.add(e))},[e,r]);const i=()=>{t(a=>a==="light"?"dark":"light")};return r?n.jsx(Gt.Provider,{value:{theme:e,toggleTheme:i},children:s}):null},Qt=()=>{const s=y.useContext(Gt);if(s===void 0)throw new Error("useTheme must be used within a ThemeProvider");return s},ut=()=>{const{theme:s,toggleTheme:e}=Qt();return n.jsx("button",{onClick:e,className:"p-2 rounded-full bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors","aria-label":s==="dark"?"Switch to light mode":"Switch to dark mode",children:s==="dark"?n.jsx(Wt,{size:20,className:"text-yellow-400"}):n.jsx(Jt,{size:20,className:"text-gray-800"})})};function Zt(s,e){return function(){return s.apply(e,arguments)}}const{toString:Vs}=Object.prototype,{getPrototypeOf:ht}=Object,{iterator:ze,toStringTag:es}=Symbol,We=(s=>e=>{const t=Vs.call(e);return s[t]||(s[t]=t.slice(8,-1).toLowerCase())})(Object.create(null)),se=s=>(s=s.toLowerCase(),e=>We(e)===s),Je=s=>e=>typeof e===s,{isArray:ve}=Array,Ee=Je("undefined");function Ks(s){return s!==null&&!Ee(s)&&s.constructor!==null&&!Ee(s.constructor)&&Y(s.constructor.isBuffer)&&s.constructor.isBuffer(s)}const ts=se("ArrayBuffer");function Xs(s){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(s):e=s&&s.buffer&&ts(s.buffer),e}const Ys=Je("string"),Y=Je("function"),ss=Je("number"),Ve=s=>s!==null&&typeof s=="object",Gs=s=>s===!0||s===!1,Ue=s=>{if(We(s)!=="object")return!1;const e=ht(s);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(es in s)&&!(ze in s)},Qs=se("Date"),Zs=se("File"),er=se("Blob"),tr=se("FileList"),sr=s=>Ve(s)&&Y(s.pipe),rr=s=>{let e;return s&&(typeof FormData=="function"&&s instanceof FormData||Y(s.append)&&((e=We(s))==="formdata"||e==="object"&&Y(s.toString)&&s.toString()==="[object FormData]"))},nr=se("URLSearchParams"),[or,ir,ar,cr]=["ReadableStream","Request","Response","Headers"].map(se),lr=s=>s.trim?s.trim():s.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Pe(s,e,{allOwnKeys:t=!1}={}){if(s===null||typeof s>"u")return;let r,o;if(typeof s!="object"&&(s=[s]),ve(s))for(r=0,o=s.length;r<o;r++)e.call(null,s[r],r,s);else{const i=t?Object.getOwnPropertyNames(s):Object.keys(s),a=i.length;let c;for(r=0;r<a;r++)c=i[r],e.call(null,s[c],c,s)}}function rs(s,e){e=e.toLowerCase();const t=Object.keys(s);let r=t.length,o;for(;r-- >0;)if(o=t[r],e===o.toLowerCase())return o;return null}const ue=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,ns=s=>!Ee(s)&&s!==ue;function nt(){const{caseless:s}=ns(this)&&this||{},e={},t=(r,o)=>{const i=s&&rs(e,o)||o;Ue(e[i])&&Ue(r)?e[i]=nt(e[i],r):Ue(r)?e[i]=nt({},r):ve(r)?e[i]=r.slice():e[i]=r};for(let r=0,o=arguments.length;r<o;r++)arguments[r]&&Pe(arguments[r],t);return e}const dr=(s,e,t,{allOwnKeys:r}={})=>(Pe(e,(o,i)=>{t&&Y(o)?s[i]=Zt(o,t):s[i]=o},{allOwnKeys:r}),s),ur=s=>(s.charCodeAt(0)===65279&&(s=s.slice(1)),s),hr=(s,e,t,r)=>{s.prototype=Object.create(e.prototype,r),s.prototype.constructor=s,Object.defineProperty(s,"super",{value:e.prototype}),t&&Object.assign(s.prototype,t)},gr=(s,e,t,r)=>{let o,i,a;const c={};if(e=e||{},s==null)return e;do{for(o=Object.getOwnPropertyNames(s),i=o.length;i-- >0;)a=o[i],(!r||r(a,s,e))&&!c[a]&&(e[a]=s[a],c[a]=!0);s=t!==!1&&ht(s)}while(s&&(!t||t(s,e))&&s!==Object.prototype);return e},fr=(s,e,t)=>{s=String(s),(t===void 0||t>s.length)&&(t=s.length),t-=e.length;const r=s.indexOf(e,t);return r!==-1&&r===t},mr=s=>{if(!s)return null;if(ve(s))return s;let e=s.length;if(!ss(e))return null;const t=new Array(e);for(;e-- >0;)t[e]=s[e];return t},pr=(s=>e=>s&&e instanceof s)(typeof Uint8Array<"u"&&ht(Uint8Array)),xr=(s,e)=>{const r=(s&&s[ze]).call(s);let o;for(;(o=r.next())&&!o.done;){const i=o.value;e.call(s,i[0],i[1])}},br=(s,e)=>{let t;const r=[];for(;(t=s.exec(e))!==null;)r.push(t);return r},yr=se("HTMLFormElement"),wr=s=>s.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(t,r,o){return r.toUpperCase()+o}),kt=(({hasOwnProperty:s})=>(e,t)=>s.call(e,t))(Object.prototype),_r=se("RegExp"),os=(s,e)=>{const t=Object.getOwnPropertyDescriptors(s),r={};Pe(t,(o,i)=>{let a;(a=e(o,i,s))!==!1&&(r[i]=a||o)}),Object.defineProperties(s,r)},vr=s=>{os(s,(e,t)=>{if(Y(s)&&["arguments","caller","callee"].indexOf(t)!==-1)return!1;const r=s[t];if(Y(r)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+t+"'")})}})},Cr=(s,e)=>{const t={},r=o=>{o.forEach(i=>{t[i]=!0})};return ve(s)?r(s):r(String(s).split(e)),t},Sr=()=>{},kr=(s,e)=>s!=null&&Number.isFinite(s=+s)?s:e;function jr(s){return!!(s&&Y(s.append)&&s[es]==="FormData"&&s[ze])}const Nr=s=>{const e=new Array(10),t=(r,o)=>{if(Ve(r)){if(e.indexOf(r)>=0)return;if(!("toJSON"in r)){e[o]=r;const i=ve(r)?[]:{};return Pe(r,(a,c)=>{const l=t(a,o+1);!Ee(l)&&(i[c]=l)}),e[o]=void 0,i}}return r};return t(s,0)},Er=se("AsyncFunction"),Rr=s=>s&&(Ve(s)||Y(s))&&Y(s.then)&&Y(s.catch),is=((s,e)=>s?setImmediate:e?((t,r)=>(ue.addEventListener("message",({source:o,data:i})=>{o===ue&&i===t&&r.length&&r.shift()()},!1),o=>{r.push(o),ue.postMessage(t,"*")}))(`axios@${Math.random()}`,[]):t=>setTimeout(t))(typeof setImmediate=="function",Y(ue.postMessage)),Tr=typeof queueMicrotask<"u"?queueMicrotask.bind(ue):typeof process<"u"&&process.nextTick||is,Pr=s=>s!=null&&Y(s[ze]),h={isArray:ve,isArrayBuffer:ts,isBuffer:Ks,isFormData:rr,isArrayBufferView:Xs,isString:Ys,isNumber:ss,isBoolean:Gs,isObject:Ve,isPlainObject:Ue,isReadableStream:or,isRequest:ir,isResponse:ar,isHeaders:cr,isUndefined:Ee,isDate:Qs,isFile:Zs,isBlob:er,isRegExp:_r,isFunction:Y,isStream:sr,isURLSearchParams:nr,isTypedArray:pr,isFileList:tr,forEach:Pe,merge:nt,extend:dr,trim:lr,stripBOM:ur,inherits:hr,toFlatObject:gr,kindOf:We,kindOfTest:se,endsWith:fr,toArray:mr,forEachEntry:xr,matchAll:br,isHTMLForm:yr,hasOwnProperty:kt,hasOwnProp:kt,reduceDescriptors:os,freezeMethods:vr,toObjectSet:Cr,toCamelCase:wr,noop:Sr,toFiniteNumber:kr,findKey:rs,global:ue,isContextDefined:ns,isSpecCompliantForm:jr,toJSONObject:Nr,isAsyncFn:Er,isThenable:Rr,setImmediate:is,asap:Tr,isIterable:Pr};function $(s,e,t,r,o){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=s,this.name="AxiosError",e&&(this.code=e),t&&(this.config=t),r&&(this.request=r),o&&(this.response=o,this.status=o.status?o.status:null)}h.inherits($,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:h.toJSONObject(this.config),code:this.code,status:this.status}}});const as=$.prototype,cs={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(s=>{cs[s]={value:s}});Object.defineProperties($,cs);Object.defineProperty(as,"isAxiosError",{value:!0});$.from=(s,e,t,r,o,i)=>{const a=Object.create(as);return h.toFlatObject(s,a,function(l){return l!==Error.prototype},c=>c!=="isAxiosError"),$.call(a,s.message,e,t,r,o),a.cause=s,a.name=s.name,i&&Object.assign(a,i),a};const Ir=null;function ot(s){return h.isPlainObject(s)||h.isArray(s)}function ls(s){return h.endsWith(s,"[]")?s.slice(0,-2):s}function jt(s,e,t){return s?s.concat(e).map(function(o,i){return o=ls(o),!t&&i?"["+o+"]":o}).join(t?".":""):e}function Ar(s){return h.isArray(s)&&!s.some(ot)}const $r=h.toFlatObject(h,{},null,function(e){return/^is[A-Z]/.test(e)});function Ke(s,e,t){if(!h.isObject(s))throw new TypeError("target must be an object");e=e||new FormData,t=h.toFlatObject(t,{metaTokens:!0,dots:!1,indexes:!1},!1,function(S,_){return!h.isUndefined(_[S])});const r=t.metaTokens,o=t.visitor||u,i=t.dots,a=t.indexes,l=(t.Blob||typeof Blob<"u"&&Blob)&&h.isSpecCompliantForm(e);if(!h.isFunction(o))throw new TypeError("visitor must be a function");function d(p){if(p===null)return"";if(h.isDate(p))return p.toISOString();if(h.isBoolean(p))return p.toString();if(!l&&h.isBlob(p))throw new $("Blob is not supported. Use a Buffer instead.");return h.isArrayBuffer(p)||h.isTypedArray(p)?l&&typeof Blob=="function"?new Blob([p]):Buffer.from(p):p}function u(p,S,_){let R=p;if(p&&!_&&typeof p=="object"){if(h.endsWith(S,"{}"))S=r?S:S.slice(0,-2),p=JSON.stringify(p);else if(h.isArray(p)&&Ar(p)||(h.isFileList(p)||h.endsWith(S,"[]"))&&(R=h.toArray(p)))return S=ls(S),R.forEach(function(x,j){!(h.isUndefined(x)||x===null)&&e.append(a===!0?jt([S],j,i):a===null?S:S+"[]",d(x))}),!1}return ot(p)?!0:(e.append(jt(_,S,i),d(p)),!1)}const b=[],N=Object.assign($r,{defaultVisitor:u,convertValue:d,isVisitable:ot});function k(p,S){if(!h.isUndefined(p)){if(b.indexOf(p)!==-1)throw Error("Circular reference detected in "+S.join("."));b.push(p),h.forEach(p,function(R,I){(!(h.isUndefined(R)||R===null)&&o.call(e,R,h.isString(I)?I.trim():I,S,N))===!0&&k(R,S?S.concat(I):[I])}),b.pop()}}if(!h.isObject(s))throw new TypeError("data must be an object");return k(s),e}function Nt(s){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(s).replace(/[!'()~]|%20|%00/g,function(r){return e[r]})}function gt(s,e){this._pairs=[],s&&Ke(s,this,e)}const ds=gt.prototype;ds.append=function(e,t){this._pairs.push([e,t])};ds.toString=function(e){const t=e?function(r){return e.call(this,r,Nt)}:Nt;return this._pairs.map(function(o){return t(o[0])+"="+t(o[1])},"").join("&")};function Or(s){return encodeURIComponent(s).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function us(s,e,t){if(!e)return s;const r=t&&t.encode||Or;h.isFunction(t)&&(t={serialize:t});const o=t&&t.serialize;let i;if(o?i=o(e,t):i=h.isURLSearchParams(e)?e.toString():new gt(e,t).toString(r),i){const a=s.indexOf("#");a!==-1&&(s=s.slice(0,a)),s+=(s.indexOf("?")===-1?"?":"&")+i}return s}class Et{constructor(){this.handlers=[]}use(e,t,r){return this.handlers.push({fulfilled:e,rejected:t,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){h.forEach(this.handlers,function(r){r!==null&&e(r)})}}const hs={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Dr=typeof URLSearchParams<"u"?URLSearchParams:gt,Ur=typeof FormData<"u"?FormData:null,Fr=typeof Blob<"u"?Blob:null,Mr={isBrowser:!0,classes:{URLSearchParams:Dr,FormData:Ur,Blob:Fr},protocols:["http","https","file","blob","url","data"]},ft=typeof window<"u"&&typeof document<"u",it=typeof navigator=="object"&&navigator||void 0,Lr=ft&&(!it||["ReactNative","NativeScript","NS"].indexOf(it.product)<0),qr=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",Br=ft&&window.location.href||"http://localhost",Hr=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:ft,hasStandardBrowserEnv:Lr,hasStandardBrowserWebWorkerEnv:qr,navigator:it,origin:Br},Symbol.toStringTag,{value:"Module"})),V={...Hr,...Mr};function zr(s,e){return Ke(s,new V.classes.URLSearchParams,Object.assign({visitor:function(t,r,o,i){return V.isNode&&h.isBuffer(t)?(this.append(r,t.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)}},e))}function Wr(s){return h.matchAll(/\w+|\[(\w*)]/g,s).map(e=>e[0]==="[]"?"":e[1]||e[0])}function Jr(s){const e={},t=Object.keys(s);let r;const o=t.length;let i;for(r=0;r<o;r++)i=t[r],e[i]=s[i];return e}function gs(s){function e(t,r,o,i){let a=t[i++];if(a==="__proto__")return!0;const c=Number.isFinite(+a),l=i>=t.length;return a=!a&&h.isArray(o)?o.length:a,l?(h.hasOwnProp(o,a)?o[a]=[o[a],r]:o[a]=r,!c):((!o[a]||!h.isObject(o[a]))&&(o[a]=[]),e(t,r,o[a],i)&&h.isArray(o[a])&&(o[a]=Jr(o[a])),!c)}if(h.isFormData(s)&&h.isFunction(s.entries)){const t={};return h.forEachEntry(s,(r,o)=>{e(Wr(r),o,t,0)}),t}return null}function Vr(s,e,t){if(h.isString(s))try{return(e||JSON.parse)(s),h.trim(s)}catch(r){if(r.name!=="SyntaxError")throw r}return(t||JSON.stringify)(s)}const Ie={transitional:hs,adapter:["xhr","http","fetch"],transformRequest:[function(e,t){const r=t.getContentType()||"",o=r.indexOf("application/json")>-1,i=h.isObject(e);if(i&&h.isHTMLForm(e)&&(e=new FormData(e)),h.isFormData(e))return o?JSON.stringify(gs(e)):e;if(h.isArrayBuffer(e)||h.isBuffer(e)||h.isStream(e)||h.isFile(e)||h.isBlob(e)||h.isReadableStream(e))return e;if(h.isArrayBufferView(e))return e.buffer;if(h.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let c;if(i){if(r.indexOf("application/x-www-form-urlencoded")>-1)return zr(e,this.formSerializer).toString();if((c=h.isFileList(e))||r.indexOf("multipart/form-data")>-1){const l=this.env&&this.env.FormData;return Ke(c?{"files[]":e}:e,l&&new l,this.formSerializer)}}return i||o?(t.setContentType("application/json",!1),Vr(e)):e}],transformResponse:[function(e){const t=this.transitional||Ie.transitional,r=t&&t.forcedJSONParsing,o=this.responseType==="json";if(h.isResponse(e)||h.isReadableStream(e))return e;if(e&&h.isString(e)&&(r&&!this.responseType||o)){const a=!(t&&t.silentJSONParsing)&&o;try{return JSON.parse(e)}catch(c){if(a)throw c.name==="SyntaxError"?$.from(c,$.ERR_BAD_RESPONSE,this,null,this.response):c}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:V.classes.FormData,Blob:V.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};h.forEach(["delete","get","head","post","put","patch"],s=>{Ie.headers[s]={}});const Kr=h.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Xr=s=>{const e={};let t,r,o;return s&&s.split(`
`).forEach(function(a){o=a.indexOf(":"),t=a.substring(0,o).trim().toLowerCase(),r=a.substring(o+1).trim(),!(!t||e[t]&&Kr[t])&&(t==="set-cookie"?e[t]?e[t].push(r):e[t]=[r]:e[t]=e[t]?e[t]+", "+r:r)}),e},Rt=Symbol("internals");function ke(s){return s&&String(s).trim().toLowerCase()}function Fe(s){return s===!1||s==null?s:h.isArray(s)?s.map(Fe):String(s)}function Yr(s){const e=Object.create(null),t=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=t.exec(s);)e[r[1]]=r[2];return e}const Gr=s=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(s.trim());function et(s,e,t,r,o){if(h.isFunction(r))return r.call(this,e,t);if(o&&(e=t),!!h.isString(e)){if(h.isString(r))return e.indexOf(r)!==-1;if(h.isRegExp(r))return r.test(e)}}function Qr(s){return s.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,t,r)=>t.toUpperCase()+r)}function Zr(s,e){const t=h.toCamelCase(" "+e);["get","set","has"].forEach(r=>{Object.defineProperty(s,r+t,{value:function(o,i,a){return this[r].call(this,e,o,i,a)},configurable:!0})})}let G=class{constructor(e){e&&this.set(e)}set(e,t,r){const o=this;function i(c,l,d){const u=ke(l);if(!u)throw new Error("header name must be a non-empty string");const b=h.findKey(o,u);(!b||o[b]===void 0||d===!0||d===void 0&&o[b]!==!1)&&(o[b||l]=Fe(c))}const a=(c,l)=>h.forEach(c,(d,u)=>i(d,u,l));if(h.isPlainObject(e)||e instanceof this.constructor)a(e,t);else if(h.isString(e)&&(e=e.trim())&&!Gr(e))a(Xr(e),t);else if(h.isObject(e)&&h.isIterable(e)){let c={},l,d;for(const u of e){if(!h.isArray(u))throw TypeError("Object iterator must return a key-value pair");c[d=u[0]]=(l=c[d])?h.isArray(l)?[...l,u[1]]:[l,u[1]]:u[1]}a(c,t)}else e!=null&&i(t,e,r);return this}get(e,t){if(e=ke(e),e){const r=h.findKey(this,e);if(r){const o=this[r];if(!t)return o;if(t===!0)return Yr(o);if(h.isFunction(t))return t.call(this,o,r);if(h.isRegExp(t))return t.exec(o);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=ke(e),e){const r=h.findKey(this,e);return!!(r&&this[r]!==void 0&&(!t||et(this,this[r],r,t)))}return!1}delete(e,t){const r=this;let o=!1;function i(a){if(a=ke(a),a){const c=h.findKey(r,a);c&&(!t||et(r,r[c],c,t))&&(delete r[c],o=!0)}}return h.isArray(e)?e.forEach(i):i(e),o}clear(e){const t=Object.keys(this);let r=t.length,o=!1;for(;r--;){const i=t[r];(!e||et(this,this[i],i,e,!0))&&(delete this[i],o=!0)}return o}normalize(e){const t=this,r={};return h.forEach(this,(o,i)=>{const a=h.findKey(r,i);if(a){t[a]=Fe(o),delete t[i];return}const c=e?Qr(i):String(i).trim();c!==i&&delete t[i],t[c]=Fe(o),r[c]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const t=Object.create(null);return h.forEach(this,(r,o)=>{r!=null&&r!==!1&&(t[o]=e&&h.isArray(r)?r.join(", "):r)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,t])=>e+": "+t).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...t){const r=new this(e);return t.forEach(o=>r.set(o)),r}static accessor(e){const r=(this[Rt]=this[Rt]={accessors:{}}).accessors,o=this.prototype;function i(a){const c=ke(a);r[c]||(Zr(o,a),r[c]=!0)}return h.isArray(e)?e.forEach(i):i(e),this}};G.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);h.reduceDescriptors(G.prototype,({value:s},e)=>{let t=e[0].toUpperCase()+e.slice(1);return{get:()=>s,set(r){this[t]=r}}});h.freezeMethods(G);function tt(s,e){const t=this||Ie,r=e||t,o=G.from(r.headers);let i=r.data;return h.forEach(s,function(c){i=c.call(t,i,o.normalize(),e?e.status:void 0)}),o.normalize(),i}function fs(s){return!!(s&&s.__CANCEL__)}function Ce(s,e,t){$.call(this,s??"canceled",$.ERR_CANCELED,e,t),this.name="CanceledError"}h.inherits(Ce,$,{__CANCEL__:!0});function ms(s,e,t){const r=t.config.validateStatus;!t.status||!r||r(t.status)?s(t):e(new $("Request failed with status code "+t.status,[$.ERR_BAD_REQUEST,$.ERR_BAD_RESPONSE][Math.floor(t.status/100)-4],t.config,t.request,t))}function en(s){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(s);return e&&e[1]||""}function tn(s,e){s=s||10;const t=new Array(s),r=new Array(s);let o=0,i=0,a;return e=e!==void 0?e:1e3,function(l){const d=Date.now(),u=r[i];a||(a=d),t[o]=l,r[o]=d;let b=i,N=0;for(;b!==o;)N+=t[b++],b=b%s;if(o=(o+1)%s,o===i&&(i=(i+1)%s),d-a<e)return;const k=u&&d-u;return k?Math.round(N*1e3/k):void 0}}function sn(s,e){let t=0,r=1e3/e,o,i;const a=(d,u=Date.now())=>{t=u,o=null,i&&(clearTimeout(i),i=null),s.apply(null,d)};return[(...d)=>{const u=Date.now(),b=u-t;b>=r?a(d,u):(o=d,i||(i=setTimeout(()=>{i=null,a(o)},r-b)))},()=>o&&a(o)]}const Le=(s,e,t=3)=>{let r=0;const o=tn(50,250);return sn(i=>{const a=i.loaded,c=i.lengthComputable?i.total:void 0,l=a-r,d=o(l),u=a<=c;r=a;const b={loaded:a,total:c,progress:c?a/c:void 0,bytes:l,rate:d||void 0,estimated:d&&c&&u?(c-a)/d:void 0,event:i,lengthComputable:c!=null,[e?"download":"upload"]:!0};s(b)},t)},Tt=(s,e)=>{const t=s!=null;return[r=>e[0]({lengthComputable:t,total:s,loaded:r}),e[1]]},Pt=s=>(...e)=>h.asap(()=>s(...e)),rn=V.hasStandardBrowserEnv?((s,e)=>t=>(t=new URL(t,V.origin),s.protocol===t.protocol&&s.host===t.host&&(e||s.port===t.port)))(new URL(V.origin),V.navigator&&/(msie|trident)/i.test(V.navigator.userAgent)):()=>!0,nn=V.hasStandardBrowserEnv?{write(s,e,t,r,o,i){const a=[s+"="+encodeURIComponent(e)];h.isNumber(t)&&a.push("expires="+new Date(t).toGMTString()),h.isString(r)&&a.push("path="+r),h.isString(o)&&a.push("domain="+o),i===!0&&a.push("secure"),document.cookie=a.join("; ")},read(s){const e=document.cookie.match(new RegExp("(^|;\\s*)("+s+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(s){this.write(s,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function on(s){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(s)}function an(s,e){return e?s.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):s}function ps(s,e,t){let r=!on(e);return s&&(r||t==!1)?an(s,e):e}const It=s=>s instanceof G?{...s}:s;function me(s,e){e=e||{};const t={};function r(d,u,b,N){return h.isPlainObject(d)&&h.isPlainObject(u)?h.merge.call({caseless:N},d,u):h.isPlainObject(u)?h.merge({},u):h.isArray(u)?u.slice():u}function o(d,u,b,N){if(h.isUndefined(u)){if(!h.isUndefined(d))return r(void 0,d,b,N)}else return r(d,u,b,N)}function i(d,u){if(!h.isUndefined(u))return r(void 0,u)}function a(d,u){if(h.isUndefined(u)){if(!h.isUndefined(d))return r(void 0,d)}else return r(void 0,u)}function c(d,u,b){if(b in e)return r(d,u);if(b in s)return r(void 0,d)}const l={url:i,method:i,data:i,baseURL:a,transformRequest:a,transformResponse:a,paramsSerializer:a,timeout:a,timeoutMessage:a,withCredentials:a,withXSRFToken:a,adapter:a,responseType:a,xsrfCookieName:a,xsrfHeaderName:a,onUploadProgress:a,onDownloadProgress:a,decompress:a,maxContentLength:a,maxBodyLength:a,beforeRedirect:a,transport:a,httpAgent:a,httpsAgent:a,cancelToken:a,socketPath:a,responseEncoding:a,validateStatus:c,headers:(d,u,b)=>o(It(d),It(u),b,!0)};return h.forEach(Object.keys(Object.assign({},s,e)),function(u){const b=l[u]||o,N=b(s[u],e[u],u);h.isUndefined(N)&&b!==c||(t[u]=N)}),t}const xs=s=>{const e=me({},s);let{data:t,withXSRFToken:r,xsrfHeaderName:o,xsrfCookieName:i,headers:a,auth:c}=e;e.headers=a=G.from(a),e.url=us(ps(e.baseURL,e.url,e.allowAbsoluteUrls),s.params,s.paramsSerializer),c&&a.set("Authorization","Basic "+btoa((c.username||"")+":"+(c.password?unescape(encodeURIComponent(c.password)):"")));let l;if(h.isFormData(t)){if(V.hasStandardBrowserEnv||V.hasStandardBrowserWebWorkerEnv)a.setContentType(void 0);else if((l=a.getContentType())!==!1){const[d,...u]=l?l.split(";").map(b=>b.trim()).filter(Boolean):[];a.setContentType([d||"multipart/form-data",...u].join("; "))}}if(V.hasStandardBrowserEnv&&(r&&h.isFunction(r)&&(r=r(e)),r||r!==!1&&rn(e.url))){const d=o&&i&&nn.read(i);d&&a.set(o,d)}return e},cn=typeof XMLHttpRequest<"u",ln=cn&&function(s){return new Promise(function(t,r){const o=xs(s);let i=o.data;const a=G.from(o.headers).normalize();let{responseType:c,onUploadProgress:l,onDownloadProgress:d}=o,u,b,N,k,p;function S(){k&&k(),p&&p(),o.cancelToken&&o.cancelToken.unsubscribe(u),o.signal&&o.signal.removeEventListener("abort",u)}let _=new XMLHttpRequest;_.open(o.method.toUpperCase(),o.url,!0),_.timeout=o.timeout;function R(){if(!_)return;const x=G.from("getAllResponseHeaders"in _&&_.getAllResponseHeaders()),C={data:!c||c==="text"||c==="json"?_.responseText:_.response,status:_.status,statusText:_.statusText,headers:x,config:s,request:_};ms(function(M){t(M),S()},function(M){r(M),S()},C),_=null}"onloadend"in _?_.onloadend=R:_.onreadystatechange=function(){!_||_.readyState!==4||_.status===0&&!(_.responseURL&&_.responseURL.indexOf("file:")===0)||setTimeout(R)},_.onabort=function(){_&&(r(new $("Request aborted",$.ECONNABORTED,s,_)),_=null)},_.onerror=function(){r(new $("Network Error",$.ERR_NETWORK,s,_)),_=null},_.ontimeout=function(){let j=o.timeout?"timeout of "+o.timeout+"ms exceeded":"timeout exceeded";const C=o.transitional||hs;o.timeoutErrorMessage&&(j=o.timeoutErrorMessage),r(new $(j,C.clarifyTimeoutError?$.ETIMEDOUT:$.ECONNABORTED,s,_)),_=null},i===void 0&&a.setContentType(null),"setRequestHeader"in _&&h.forEach(a.toJSON(),function(j,C){_.setRequestHeader(C,j)}),h.isUndefined(o.withCredentials)||(_.withCredentials=!!o.withCredentials),c&&c!=="json"&&(_.responseType=o.responseType),d&&([N,p]=Le(d,!0),_.addEventListener("progress",N)),l&&_.upload&&([b,k]=Le(l),_.upload.addEventListener("progress",b),_.upload.addEventListener("loadend",k)),(o.cancelToken||o.signal)&&(u=x=>{_&&(r(!x||x.type?new Ce(null,s,_):x),_.abort(),_=null)},o.cancelToken&&o.cancelToken.subscribe(u),o.signal&&(o.signal.aborted?u():o.signal.addEventListener("abort",u)));const I=en(o.url);if(I&&V.protocols.indexOf(I)===-1){r(new $("Unsupported protocol "+I+":",$.ERR_BAD_REQUEST,s));return}_.send(i||null)})},dn=(s,e)=>{const{length:t}=s=s?s.filter(Boolean):[];if(e||t){let r=new AbortController,o;const i=function(d){if(!o){o=!0,c();const u=d instanceof Error?d:this.reason;r.abort(u instanceof $?u:new Ce(u instanceof Error?u.message:u))}};let a=e&&setTimeout(()=>{a=null,i(new $(`timeout ${e} of ms exceeded`,$.ETIMEDOUT))},e);const c=()=>{s&&(a&&clearTimeout(a),a=null,s.forEach(d=>{d.unsubscribe?d.unsubscribe(i):d.removeEventListener("abort",i)}),s=null)};s.forEach(d=>d.addEventListener("abort",i));const{signal:l}=r;return l.unsubscribe=()=>h.asap(c),l}},un=function*(s,e){let t=s.byteLength;if(t<e){yield s;return}let r=0,o;for(;r<t;)o=r+e,yield s.slice(r,o),r=o},hn=async function*(s,e){for await(const t of gn(s))yield*un(t,e)},gn=async function*(s){if(s[Symbol.asyncIterator]){yield*s;return}const e=s.getReader();try{for(;;){const{done:t,value:r}=await e.read();if(t)break;yield r}}finally{await e.cancel()}},At=(s,e,t,r)=>{const o=hn(s,e);let i=0,a,c=l=>{a||(a=!0,r&&r(l))};return new ReadableStream({async pull(l){try{const{done:d,value:u}=await o.next();if(d){c(),l.close();return}let b=u.byteLength;if(t){let N=i+=b;t(N)}l.enqueue(new Uint8Array(u))}catch(d){throw c(d),d}},cancel(l){return c(l),o.return()}},{highWaterMark:2})},Xe=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",bs=Xe&&typeof ReadableStream=="function",fn=Xe&&(typeof TextEncoder=="function"?(s=>e=>s.encode(e))(new TextEncoder):async s=>new Uint8Array(await new Response(s).arrayBuffer())),ys=(s,...e)=>{try{return!!s(...e)}catch{return!1}},mn=bs&&ys(()=>{let s=!1;const e=new Request(V.origin,{body:new ReadableStream,method:"POST",get duplex(){return s=!0,"half"}}).headers.has("Content-Type");return s&&!e}),$t=64*1024,at=bs&&ys(()=>h.isReadableStream(new Response("").body)),qe={stream:at&&(s=>s.body)};Xe&&(s=>{["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!qe[e]&&(qe[e]=h.isFunction(s[e])?t=>t[e]():(t,r)=>{throw new $(`Response type '${e}' is not supported`,$.ERR_NOT_SUPPORT,r)})})})(new Response);const pn=async s=>{if(s==null)return 0;if(h.isBlob(s))return s.size;if(h.isSpecCompliantForm(s))return(await new Request(V.origin,{method:"POST",body:s}).arrayBuffer()).byteLength;if(h.isArrayBufferView(s)||h.isArrayBuffer(s))return s.byteLength;if(h.isURLSearchParams(s)&&(s=s+""),h.isString(s))return(await fn(s)).byteLength},xn=async(s,e)=>{const t=h.toFiniteNumber(s.getContentLength());return t??pn(e)},bn=Xe&&(async s=>{let{url:e,method:t,data:r,signal:o,cancelToken:i,timeout:a,onDownloadProgress:c,onUploadProgress:l,responseType:d,headers:u,withCredentials:b="same-origin",fetchOptions:N}=xs(s);d=d?(d+"").toLowerCase():"text";let k=dn([o,i&&i.toAbortSignal()],a),p;const S=k&&k.unsubscribe&&(()=>{k.unsubscribe()});let _;try{if(l&&mn&&t!=="get"&&t!=="head"&&(_=await xn(u,r))!==0){let C=new Request(e,{method:"POST",body:r,duplex:"half"}),F;if(h.isFormData(r)&&(F=C.headers.get("content-type"))&&u.setContentType(F),C.body){const[M,T]=Tt(_,Le(Pt(l)));r=At(C.body,$t,M,T)}}h.isString(b)||(b=b?"include":"omit");const R="credentials"in Request.prototype;p=new Request(e,{...N,signal:k,method:t.toUpperCase(),headers:u.normalize().toJSON(),body:r,duplex:"half",credentials:R?b:void 0});let I=await fetch(p,N);const x=at&&(d==="stream"||d==="response");if(at&&(c||x&&S)){const C={};["status","statusText","headers"].forEach(q=>{C[q]=I[q]});const F=h.toFiniteNumber(I.headers.get("content-length")),[M,T]=c&&Tt(F,Le(Pt(c),!0))||[];I=new Response(At(I.body,$t,M,()=>{T&&T(),S&&S()}),C)}d=d||"text";let j=await qe[h.findKey(qe,d)||"text"](I,s);return!x&&S&&S(),await new Promise((C,F)=>{ms(C,F,{data:j,headers:G.from(I.headers),status:I.status,statusText:I.statusText,config:s,request:p})})}catch(R){throw S&&S(),R&&R.name==="TypeError"&&/Load failed|fetch/i.test(R.message)?Object.assign(new $("Network Error",$.ERR_NETWORK,s,p),{cause:R.cause||R}):$.from(R,R&&R.code,s,p)}}),ct={http:Ir,xhr:ln,fetch:bn};h.forEach(ct,(s,e)=>{if(s){try{Object.defineProperty(s,"name",{value:e})}catch{}Object.defineProperty(s,"adapterName",{value:e})}});const Ot=s=>`- ${s}`,yn=s=>h.isFunction(s)||s===null||s===!1,ws={getAdapter:s=>{s=h.isArray(s)?s:[s];const{length:e}=s;let t,r;const o={};for(let i=0;i<e;i++){t=s[i];let a;if(r=t,!yn(t)&&(r=ct[(a=String(t)).toLowerCase()],r===void 0))throw new $(`Unknown adapter '${a}'`);if(r)break;o[a||"#"+i]=r}if(!r){const i=Object.entries(o).map(([c,l])=>`adapter ${c} `+(l===!1?"is not supported by the environment":"is not available in the build"));let a=e?i.length>1?`since :
`+i.map(Ot).join(`
`):" "+Ot(i[0]):"as no adapter specified";throw new $("There is no suitable adapter to dispatch the request "+a,"ERR_NOT_SUPPORT")}return r},adapters:ct};function st(s){if(s.cancelToken&&s.cancelToken.throwIfRequested(),s.signal&&s.signal.aborted)throw new Ce(null,s)}function Dt(s){return st(s),s.headers=G.from(s.headers),s.data=tt.call(s,s.transformRequest),["post","put","patch"].indexOf(s.method)!==-1&&s.headers.setContentType("application/x-www-form-urlencoded",!1),ws.getAdapter(s.adapter||Ie.adapter)(s).then(function(r){return st(s),r.data=tt.call(s,s.transformResponse,r),r.headers=G.from(r.headers),r},function(r){return fs(r)||(st(s),r&&r.response&&(r.response.data=tt.call(s,s.transformResponse,r.response),r.response.headers=G.from(r.response.headers))),Promise.reject(r)})}const _s="1.10.0",Ye={};["object","boolean","number","function","string","symbol"].forEach((s,e)=>{Ye[s]=function(r){return typeof r===s||"a"+(e<1?"n ":" ")+s}});const Ut={};Ye.transitional=function(e,t,r){function o(i,a){return"[Axios v"+_s+"] Transitional option '"+i+"'"+a+(r?". "+r:"")}return(i,a,c)=>{if(e===!1)throw new $(o(a," has been removed"+(t?" in "+t:"")),$.ERR_DEPRECATED);return t&&!Ut[a]&&(Ut[a]=!0,console.warn(o(a," has been deprecated since v"+t+" and will be removed in the near future"))),e?e(i,a,c):!0}};Ye.spelling=function(e){return(t,r)=>(console.warn(`${r} is likely a misspelling of ${e}`),!0)};function wn(s,e,t){if(typeof s!="object")throw new $("options must be an object",$.ERR_BAD_OPTION_VALUE);const r=Object.keys(s);let o=r.length;for(;o-- >0;){const i=r[o],a=e[i];if(a){const c=s[i],l=c===void 0||a(c,i,s);if(l!==!0)throw new $("option "+i+" must be "+l,$.ERR_BAD_OPTION_VALUE);continue}if(t!==!0)throw new $("Unknown option "+i,$.ERR_BAD_OPTION)}}const Me={assertOptions:wn,validators:Ye},re=Me.validators;let he=class{constructor(e){this.defaults=e||{},this.interceptors={request:new Et,response:new Et}}async request(e,t){try{return await this._request(e,t)}catch(r){if(r instanceof Error){let o={};Error.captureStackTrace?Error.captureStackTrace(o):o=new Error;const i=o.stack?o.stack.replace(/^.+\n/,""):"";try{r.stack?i&&!String(r.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+i):r.stack=i}catch{}}throw r}}_request(e,t){typeof e=="string"?(t=t||{},t.url=e):t=e||{},t=me(this.defaults,t);const{transitional:r,paramsSerializer:o,headers:i}=t;r!==void 0&&Me.assertOptions(r,{silentJSONParsing:re.transitional(re.boolean),forcedJSONParsing:re.transitional(re.boolean),clarifyTimeoutError:re.transitional(re.boolean)},!1),o!=null&&(h.isFunction(o)?t.paramsSerializer={serialize:o}:Me.assertOptions(o,{encode:re.function,serialize:re.function},!0)),t.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),Me.assertOptions(t,{baseUrl:re.spelling("baseURL"),withXsrfToken:re.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let a=i&&h.merge(i.common,i[t.method]);i&&h.forEach(["delete","get","head","post","put","patch","common"],p=>{delete i[p]}),t.headers=G.concat(a,i);const c=[];let l=!0;this.interceptors.request.forEach(function(S){typeof S.runWhen=="function"&&S.runWhen(t)===!1||(l=l&&S.synchronous,c.unshift(S.fulfilled,S.rejected))});const d=[];this.interceptors.response.forEach(function(S){d.push(S.fulfilled,S.rejected)});let u,b=0,N;if(!l){const p=[Dt.bind(this),void 0];for(p.unshift.apply(p,c),p.push.apply(p,d),N=p.length,u=Promise.resolve(t);b<N;)u=u.then(p[b++],p[b++]);return u}N=c.length;let k=t;for(b=0;b<N;){const p=c[b++],S=c[b++];try{k=p(k)}catch(_){S.call(this,_);break}}try{u=Dt.call(this,k)}catch(p){return Promise.reject(p)}for(b=0,N=d.length;b<N;)u=u.then(d[b++],d[b++]);return u}getUri(e){e=me(this.defaults,e);const t=ps(e.baseURL,e.url,e.allowAbsoluteUrls);return us(t,e.params,e.paramsSerializer)}};h.forEach(["delete","get","head","options"],function(e){he.prototype[e]=function(t,r){return this.request(me(r||{},{method:e,url:t,data:(r||{}).data}))}});h.forEach(["post","put","patch"],function(e){function t(r){return function(i,a,c){return this.request(me(c||{},{method:e,headers:r?{"Content-Type":"multipart/form-data"}:{},url:i,data:a}))}}he.prototype[e]=t(),he.prototype[e+"Form"]=t(!0)});let _n=class vs{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(i){t=i});const r=this;this.promise.then(o=>{if(!r._listeners)return;let i=r._listeners.length;for(;i-- >0;)r._listeners[i](o);r._listeners=null}),this.promise.then=o=>{let i;const a=new Promise(c=>{r.subscribe(c),i=c}).then(o);return a.cancel=function(){r.unsubscribe(i)},a},e(function(i,a,c){r.reason||(r.reason=new Ce(i,a,c),t(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);t!==-1&&this._listeners.splice(t,1)}toAbortSignal(){const e=new AbortController,t=r=>{e.abort(r)};return this.subscribe(t),e.signal.unsubscribe=()=>this.unsubscribe(t),e.signal}static source(){let e;return{token:new vs(function(o){e=o}),cancel:e}}};function vn(s){return function(t){return s.apply(null,t)}}function Cn(s){return h.isObject(s)&&s.isAxiosError===!0}const lt={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(lt).forEach(([s,e])=>{lt[e]=s});function Cs(s){const e=new he(s),t=Zt(he.prototype.request,e);return h.extend(t,he.prototype,e,{allOwnKeys:!0}),h.extend(t,e,null,{allOwnKeys:!0}),t.create=function(o){return Cs(me(s,o))},t}const E=Cs(Ie);E.Axios=he;E.CanceledError=Ce;E.CancelToken=_n;E.isCancel=fs;E.VERSION=_s;E.toFormData=Ke;E.AxiosError=$;E.Cancel=E.CanceledError;E.all=function(e){return Promise.all(e)};E.spread=vn;E.isAxiosError=Cn;E.mergeConfig=me;E.AxiosHeaders=G;E.formToJSON=s=>gs(h.isHTMLForm(s)?new FormData(s):s);E.getAdapter=ws.getAdapter;E.HttpStatusCode=lt;E.default=E;const{Axios:ko,AxiosError:jo,CanceledError:No,isCancel:Eo,CancelToken:Ro,VERSION:To,all:Po,Cancel:Io,isAxiosError:Ao,spread:$o,toFormData:Oo,AxiosHeaders:Do,HttpStatusCode:Uo,formToJSON:Fo,getAdapter:Mo,mergeConfig:Lo}=E,Sn=()=>{const s=JSON.parse(sessionStorage.getItem("currentUser")||"{}"),e=s.id||s.Id,[t,r]=y.useState(null);return console.log("Header - currentUser:",s),console.log("Header - userId:",e),y.useEffect(()=>{if(console.log("useEffect running with userId:",e),!e){console.log("No userId found in header");return}(async()=>{try{console.log("Fetching profile for user:",e);const i=await E.get(`http://localhost:5082/api/users/${e}`);console.log("Profile data received:",i.data),r(i.data)}catch(i){console.error("Failed to load profile data",i)}})()},[e]),n.jsxs("header",{className:"bg-white dark:bg-gray-800 shadow-sm py-4 px-6 flex items-center justify-between",children:[n.jsx(W,{to:"/",className:"text-xl font-bold text-blue-600 dark:text-blue-400",children:"ClassConnect"}),n.jsxs("div",{className:"flex items-center space-x-4",children:[n.jsx(ut,{}),n.jsxs("button",{className:"p-2 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors relative","aria-label":"Notifications",children:[n.jsx(As,{size:20}),n.jsx("span",{className:"absolute top-0 right-0 bg-red-500 text-white text-xs rounded-full h-4 w-4 flex items-center justify-center",children:"3"})]}),n.jsx(W,{to:"/profile",className:"flex items-center",children:n.jsx("img",{src:t?.profilePictureUrl,alt:"Profile",className:"h-8 w-8 rounded-full border-2 border-blue-500"})})]})]})},kn=({onLogout:s})=>{const[e,t]=y.useState(!1),r=()=>{t(!e)},o=[{path:"/",icon:n.jsx(Os,{size:20}),label:"Home"},{path:"/profile",icon:n.jsx(Vt,{size:20}),label:"Profile"},{path:"/courses",icon:n.jsx(Ne,{size:20}),label:"Courses"},{path:"/chat",icon:n.jsx(ce,{size:20}),label:"Chats"},{path:"/connections",icon:n.jsx(He,{size:20}),label:"Connections"}];return n.jsxs(n.Fragment,{children:[n.jsx("button",{onClick:r,className:"md:hidden fixed top-4 left-4 z-50 p-2 bg-blue-500 text-white rounded-md","aria-label":"Toggle sidebar",children:e?n.jsx(_e,{size:20}):n.jsx($s,{size:20})}),n.jsx("aside",{className:`bg-white dark:bg-gray-800 w-64 border-r border-gray-200 dark:border-gray-700 transition-all duration-300 fixed md:static top-0 bottom-0 left-0 z-40 ${e?"translate-x-0":"-translate-x-full md:translate-x-0"}`,children:n.jsxs("div",{className:"p-4",children:[n.jsx("h2",{className:"text-xl font-bold text-center text-blue-600 dark:text-blue-400 mb-8 mt-4",children:"ClassConnect"}),n.jsx("nav",{className:"space-y-2",children:o.map(i=>n.jsxs(Rs,{to:i.path,className:({isActive:a})=>`flex items-center space-x-3 px-4 py-3 rounded-lg transition-colors ${a?"bg-blue-100 dark:bg-blue-900/40 text-blue-600 dark:text-blue-400":"hover:bg-gray-100 dark:hover:bg-gray-700"}`,onClick:()=>t(!1),children:[i.icon,n.jsx("span",{children:i.label})]},i.path))}),n.jsx("button",{onClick:()=>{t(!1),s()},className:"w-full flex items-center justify-center mt-8 px-4 py-3 rounded-lg bg-red-500 text-white font-semibold hover:bg-red-600 transition-colors",children:"Log Out"})]})})]})},jn=({children:s,onLogout:e})=>n.jsxs("div",{className:"flex flex-col min-h-screen bg-gray-50 dark:bg-gray-900 text-gray-900 dark:text-gray-100 transition-colors duration-200",children:[n.jsx(Sn,{}),n.jsxs("div",{className:"flex flex-1",children:[n.jsx(kn,{onLogout:e}),n.jsx("main",{className:"flex-1 p-4 md:p-6 overflow-auto",children:s})]})]}),Ae=()=>{const[s,e]=y.useState([]),t=y.useCallback((a,c)=>{const l=Date.now().toString();e(d=>[...d,{id:l,message:a,type:c}])},[]),r=y.useCallback(a=>{e(c=>c.filter(l=>l.id!==a))},[]),o=y.useCallback(a=>{t(a,"success")},[t]),i=y.useCallback(a=>{t(a,"error")},[t]);return{toasts:s,showSuccess:o,showError:i,hideToast:r}},je="http://localhost:5082/api",Nn=()=>{const[s,e]=y.useState([]),[t,r]=y.useState([]),[o,i]=y.useState([]),[a,c]=y.useState(!0),{showSuccess:l,showError:d}=Ae(),u=JSON.parse(sessionStorage.getItem("currentUser")||"{}"),b=u.id,N=u.name||"User",k=y.useCallback(async()=>{try{console.log("🔄 Fetching recent course chats...");const j=(await E.get(`${je}/Dashboard/recent-course-chats/${b}`)).data.map(C=>({id:C.id,courseName:C.courseName,lastMessage:C.lastMessage,lastMessageSender:C.lastMessageSender,lastMessageTime:C.lastMessageTime?I(C.lastMessageTime):"",participantCount:C.participantCount}));e(j),console.log(`✅ Loaded ${j.length} recent course chats`)}catch(x){console.error("❌ Error fetching recent course chats:",x),e([])}},[b]),p=y.useCallback(async()=>{try{console.log("🔄 Fetching recent private chats...");const j=(await E.get(`${je}/Dashboard/recent-private-chats/${b}`)).data.map(C=>({id:C.id,otherUserName:C.otherUserName,otherUserAvatar:C.otherUserAvatar,lastMessage:C.lastMessage,lastMessageTime:C.lastMessageTime?I(C.lastMessageTime):"",isRead:C.isRead}));r(j),console.log(`✅ Loaded ${j.length} recent private chats`)}catch(x){console.error("❌ Error fetching recent private chats:",x),r([])}},[b]),S=y.useCallback(async()=>{try{const x=await E.get(`${je}/Connection/pending/${b}`);i(x.data.slice(0,3))}catch(x){console.error("Error fetching connection requests:",x),i([])}},[b]),_=async x=>{try{await E.post(`${je}/Connection/requests/${x}/accept`),i(j=>j.filter(C=>C.id!==x)),l("Connection request accepted!")}catch(j){console.error("Error accepting connection request:",j),d("Failed to accept connection request")}},R=async x=>{try{await E.post(`${je}/Connection/requests/${x}/reject`),i(j=>j.filter(C=>C.id!==x)),l("Connection request declined")}catch(j){console.error("Error rejecting connection request:",j),d("Failed to reject connection request")}},I=x=>{const j=new Date(x),F=Math.floor((new Date().getTime()-j.getTime())/(1e3*60));return F<1?"Just now":F<60?`${F}m ago`:F<1440?`${Math.floor(F/60)}h ago`:`${Math.floor(F/1440)}d ago`};return y.useEffect(()=>{(async()=>{b&&(c(!0),await Promise.all([k(),p(),S()]),c(!1))})()},[b,k,p,S]),a?n.jsx("div",{className:"flex items-center justify-center h-64",children:n.jsx("div",{className:"text-lg text-gray-500 dark:text-gray-400",children:"Loading..."})}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs("section",{className:"bg-gradient-to-r from-blue-600 to-blue-800 rounded-xl p-6 text-white",children:[n.jsxs("h1",{className:"text-2xl font-bold mb-2",children:["Welcome back, ",N,"!"]}),n.jsx("p",{className:"opacity-90",children:"Connect with classmates, discuss course material, and stay on top of your studies."})]}),n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[n.jsxs("section",{className:"bg-white dark:bg-gray-800 rounded-xl shadow p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("h2",{className:"text-lg font-semibold flex items-center",children:[n.jsx(Ne,{size:18,className:"mr-2 text-blue-500"}),"Recent Course Chats"]}),n.jsx(W,{to:"/chat",className:"text-sm text-blue-600 dark:text-blue-400 hover:underline",children:"View all"})]}),s.length>0?n.jsx("div",{className:"space-y-4",children:s.map(x=>n.jsx(W,{to:`/chat/${x.id}`,className:"block border-b border-gray-200 dark:border-gray-700 pb-3 last:border-0 last:pb-0 hover:bg-gray-50 dark:hover:bg-gray-700 p-2 rounded transition-colors",children:n.jsxs("div",{className:"flex justify-between items-start",children:[n.jsxs("div",{className:"flex-1",children:[n.jsx("p",{className:"font-medium text-gray-900 dark:text-gray-100",children:x.courseName}),n.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-300 mt-1",children:[x.lastMessageSender&&n.jsxs("span",{className:"font-medium",children:[x.lastMessageSender,": "]}),x.lastMessage]}),n.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:[x.participantCount," participants"]})]}),x.lastMessageTime&&n.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 ml-2",children:x.lastMessageTime})]})},x.id))}):n.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"No course chats available. Join a course to start chatting!"})]}),n.jsxs("section",{className:"bg-white dark:bg-gray-800 rounded-xl shadow p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("h2",{className:"text-lg font-semibold flex items-center",children:[n.jsx(ce,{size:18,className:"mr-2 text-green-500"}),"Recent Private Chats"]}),n.jsx(W,{to:"/chat?type=private",className:"text-sm text-blue-600 dark:text-blue-400 hover:underline",children:"View all"})]}),t.length>0?n.jsx("div",{className:"space-y-4",children:t.map(x=>n.jsx(W,{to:`/chat?type=private&chatId=${x.id}`,className:"block border-b border-gray-200 dark:border-gray-700 pb-3 last:border-0 last:pb-0 hover:bg-gray-50 dark:hover:bg-gray-700 p-2 rounded transition-colors",children:n.jsxs("div",{className:"flex items-start space-x-3",children:[n.jsx("img",{src:x.otherUserAvatar,alt:x.otherUserName,className:"w-8 h-8 rounded-full object-cover"}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsxs("div",{className:"flex justify-between items-start",children:[n.jsx("p",{className:"font-medium text-gray-900 dark:text-gray-100 truncate",children:x.otherUserName}),x.lastMessageTime&&n.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 ml-2",children:x.lastMessageTime})]}),n.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300 mt-1 truncate",children:x.lastMessage})]})]})},x.id))}):n.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"No private chats yet. Connect with classmates to start chatting!"})]}),n.jsxs("section",{className:"bg-white dark:bg-gray-800 rounded-xl shadow p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("h2",{className:"text-lg font-semibold flex items-center",children:[n.jsx(He,{size:18,className:"mr-2 text-purple-500"}),"Connection Requests"]}),n.jsx(W,{to:"/connections",className:"text-sm text-blue-600 dark:text-blue-400 hover:underline",children:"View all"})]}),o.length>0?n.jsx("div",{className:"space-y-4",children:o.map(x=>n.jsx("div",{className:"border-b border-gray-200 dark:border-gray-700 pb-3 last:border-0 last:pb-0",children:n.jsxs("div",{className:"flex items-start space-x-3",children:[n.jsx("img",{src:x.avatar||"/default-avatar.png",alt:x.name,className:"w-10 h-10 rounded-full object-cover"}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("p",{className:"font-medium text-gray-900 dark:text-gray-100",children:x.name}),n.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[x.major," • ",x.year]}),n.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:x.course}),n.jsxs("div",{className:"flex space-x-2 mt-2",children:[n.jsxs("button",{onClick:()=>_(x.id),className:"flex items-center px-2 py-1 text-xs bg-green-500 hover:bg-green-600 text-white rounded transition-colors",children:[n.jsx(Kt,{size:12,className:"mr-1"}),"Accept"]}),n.jsxs("button",{onClick:()=>R(x.id),className:"flex items-center px-2 py-1 text-xs bg-red-500 hover:bg-red-600 text-white rounded transition-colors",children:[n.jsx(_e,{size:12,className:"mr-1"}),"Decline"]})]})]})]})},x.id))}):n.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"No pending connection requests. Check back later!"})]})]})]})},Ge=({message:s,type:e,onClose:t,duration:r=3e3})=>(y.useEffect(()=>{const o=setTimeout(t,r);return()=>clearTimeout(o)},[t,r]),n.jsxs("div",{className:`fixed top-4 right-4 z-50 flex items-center p-4 rounded-lg shadow-lg min-w-80 max-w-md ${e==="success"?"bg-green-50 dark:bg-green-900 border border-green-200 dark:border-green-700":"bg-red-50 dark:bg-red-900 border border-red-200 dark:border-red-700"}`,children:[e==="success"?n.jsx(Ds,{className:"w-5 h-5 text-green-500 dark:text-green-400 mr-3"}):n.jsx(Us,{className:"w-5 h-5 text-red-500 dark:text-red-400 mr-3"}),n.jsx("span",{className:`flex-1 text-sm font-medium ${e==="success"?"text-green-800 dark:text-green-200":"text-red-800 dark:text-red-200"}`,children:s}),n.jsx("button",{onClick:t,className:`ml-3 p-1 rounded-full hover:bg-opacity-20 ${e==="success"?"hover:bg-green-500 text-green-600 dark:text-green-400":"hover:bg-red-500 text-red-600 dark:text-red-400"}`,children:n.jsx(_e,{size:16})})]})),En=()=>{const e=JSON.parse(sessionStorage.getItem("currentUser")||"{}").id,[t,r]=y.useState(!1),[o,i]=y.useState(null),[a,c]=y.useState(!0),[l,d]=y.useState(""),[u,b]=y.useState([]),[N,k]=y.useState(null),{toasts:p,showSuccess:S,showError:_,hideToast:R}=Ae(),I=["First Year","Second Year","Third Year","Fourth Year","PostGraduate"];y.useEffect(()=>{(async()=>{try{const q=await E.get(`http://localhost:5082/api/users/${e}`),U=await E.get("http://localhost:5082/api/courses");i(q.data),b(U.data),c(!1)}catch{d("Failed to load profile"),c(!1)}})()},[e]);const x=T=>{if(!o)return;const{name:q,value:U}=T.target;i({...o,[q]:U})},j=()=>{o&&E.put(`http://localhost:5082/api/users/${e}`,{id:o.id,name:o.name,bio:o.bio,year:o.year,major:o.major}).then(()=>{S("Profile updated successfully!"),r(!1)}).catch(()=>_("Failed to update profile"))},C=async()=>{if(!(!N||!o))try{await E.post(`http://localhost:5082/api/users/${e}/enroll/${N}`);const T=u.find(q=>q.id===N);T&&(i({...o,enrolledCourses:[...o.enrolledCourses,T]}),S(`Successfully enrolled in ${T.name}!`)),k(null)}catch(T){console.error(T),_("Failed to enroll in course")}},F=async T=>{if(!o)return;const q=o.enrolledCourses.find(U=>U.id===T);try{await E.delete(`http://localhost:5082/api/users/${e}/unenroll/${T}`),i({...o,enrolledCourses:o.enrolledCourses.filter(U=>U.id!==T)}),S(`Successfully removed ${q?.name||"course"}`)}catch(U){console.error(U),_("Failed to remove course")}},M=u.filter(T=>!o?.enrolledCourses.some(q=>q.id===T.id));return a?n.jsx("p",{className:"text-center mt-10",children:"Loading..."}):l||!o?n.jsx("p",{className:"text-center text-red-600 mt-10",children:l}):n.jsxs("div",{className:"max-w-4xl mx-auto",children:[n.jsx("div",{className:"fixed top-0 right-0 z-50 space-y-2 p-4",children:p.map(T=>n.jsx(Ge,{message:T.message,type:T.type,onClose:()=>R(T.id)},T.id))}),n.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow overflow-hidden",children:[n.jsxs("div",{className:"relative h-48 bg-gradient-to-r from-blue-400 to-blue-600",children:[n.jsx("div",{className:"absolute -bottom-12 left-6",children:n.jsx("img",{src:o.profilePictureUrl,alt:"Profile",className:"h-24 w-24 rounded-full border-4 border-white dark:border-gray-800"})}),n.jsx("button",{onClick:()=>r(!t),className:"absolute top-4 right-4 bg-white dark:bg-gray-700 p-2 rounded-full shadow hover:bg-gray-50 dark:hover:bg-gray-600 transition-colors",children:n.jsx(Fs,{size:16})})]}),n.jsx("div",{className:"pt-16 pb-8 px-6",children:t?n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Name"}),n.jsx("input",{type:"text",name:"name",value:o.name,onChange:x,className:"w-full px-3 py-2 border rounded-md dark:bg-gray-700 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Year"}),n.jsx("select",{name:"year",value:o.year,onChange:x,className:"w-full px-3 py-2 border rounded-md dark:bg-gray-700 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",children:I.map(T=>n.jsx("option",{value:T,children:T},T))})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Major"}),n.jsx("input",{type:"text",name:"major",value:o.major,onChange:x,className:"w-full px-3 py-2 border rounded-md dark:bg-gray-700 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Bio"}),n.jsx("textarea",{name:"bio",value:o.bio,onChange:x,rows:3,className:"w-full px-3 py-2 border rounded-md dark:bg-gray-700 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors"})]}),n.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[n.jsx("button",{onClick:()=>r(!1),className:"px-4 py-2 border rounded-md text-sm hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:"Cancel"}),n.jsx("button",{onClick:j,className:"px-4 py-2 rounded-md text-sm text-white bg-blue-600 hover:bg-blue-700 transition-colors",children:"Save Changes"})]})]}):n.jsxs(n.Fragment,{children:[n.jsx("h1",{className:"text-2xl font-bold",children:o.name}),n.jsxs("p",{className:"mt-2 text-gray-600 dark:text-gray-400",children:[o.year," | Major: ",o.major]}),n.jsx("p",{className:"mt-4 text-gray-700 dark:text-gray-300",children:o.bio})]})})]}),n.jsxs("div",{className:"mt-6 bg-white dark:bg-gray-800 rounded-xl shadow p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4 pb-2",children:[n.jsxs("h2",{className:"text-lg font-semibold flex items-center",children:[n.jsx(Ne,{size:18,className:"mr-2 text-blue-500"}),"My Courses"]}),n.jsxs("div",{className:"flex space-x-2 items-center",children:[n.jsxs("select",{value:N||"",onChange:T=>k(Number(T.target.value)),className:"px-2 py-2 border rounded-md bg-white dark:bg-gray-700 text-gray-800 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",children:[n.jsx("option",{value:"",children:"Select Course"}),M.map(T=>n.jsxs("option",{value:T.id,children:[T.name," (",T.code,")"]},T.id))]}),n.jsx("button",{onClick:C,disabled:!N,className:"px-3 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 text-sm disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"Add"})]})]}),o.enrolledCourses.length>0?n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:o.enrolledCourses.map(T=>n.jsxs("div",{className:"border rounded-lg p-4 relative group hover:border-blue-500 transition-colors bg-gray-50 dark:bg-gray-700",children:[n.jsx("p",{className:"font-semibold",children:T.name}),n.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:T.code}),n.jsx("button",{onClick:()=>F(T.id),className:"absolute top-2 right-2 text-red-500 opacity-0 group-hover:opacity-100 transition-opacity hover:text-red-700",title:"Remove course",children:n.jsx(_e,{size:16})})]},T.id))}):n.jsxs("div",{className:"text-center py-8",children:[n.jsx(Ne,{size:48,className:"mx-auto text-gray-400 mb-4"}),n.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"No courses enrolled yet. Add your first course above!"})]})]})]})},be=["All","Computer Science","Mathematics","Physics","Chemistry","Biology"],Rn=()=>{const e=JSON.parse(sessionStorage.getItem("currentUser")||"{}").id,t=e===38,[r,o]=y.useState([]),[i,a]=y.useState(""),[c,l]=y.useState("All"),[d,u]=y.useState(!1),[b,N]=y.useState([]),[k,p]=y.useState(null),[S,_]=y.useState({}),[R,I]=y.useState({code:"",name:"",department:be[1],professor:"",description:""}),{toasts:x,showSuccess:j,showError:C,hideToast:F}=Ae();y.useEffect(()=>{E.get("http://localhost:5082/api/courses").then(w=>o(w.data)).catch(w=>console.error("Failed to fetch courses",w)),E.get(`http://localhost:5082/api/courses/user/${e}`).then(w=>N(w.data)).catch(w=>console.error("Failed to fetch user's enrolled courses",w))},[e]);const M=w=>{E.delete(`http://localhost:5082/api/courses/${w}`).then(()=>{j("Course removed successfully!"),o(f=>f.filter(v=>v.id!==w))}).catch(f=>{console.error("Delete error:",f.response?.data||f.message),C("Failed to remove course")})},T=()=>{E.post("http://localhost:5082/api/courses",R).then(w=>{j("Course created successfully!"),o(f=>[...f,w.data]),u(!1),I({code:"",name:"",department:be[1],professor:"",description:""})}).catch(()=>C("Failed to create course"))},q=w=>{p(w.id),_(w)},U=()=>{p(null),_({})},X=(w,f)=>{_(v=>({...v,[w]:f}))},Z=async()=>{if(k)try{const w={...S,id:k};await E.put(`http://localhost:5082/api/courses/${k}`,w),j("Course updated successfully!"),o(f=>f.map(v=>v.id===k?w:v)),p(null),_({})}catch(w){C("Failed to update course"),console.error(w)}},oe=async(w,f)=>{try{f?(await E.delete(`http://localhost:5082/api/users/${e}/unenroll/${w}`),j("Unenrolled from course!")):(await E.post(`http://localhost:5082/api/users/${e}/enroll/${w}`),j("Enrolled in course!"));const v=await E.get(`http://localhost:5082/api/courses/user/${e}`);N(v.data)}catch{C("Failed to update enrollment")}},xe=r.filter(w=>{const f=w.name.toLowerCase().includes(i.toLowerCase())||w.code.toLowerCase().includes(i.toLowerCase()),v=c==="All"||w.department===c;return f&&v}),le=new Set(b.map(w=>w.id)),ie=xe.filter(w=>le.has(w.id)),de=xe.filter(w=>!le.has(w.id)),ae=(w,f=!1)=>{const v=b.some(m=>m.id===w.id);return n.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow hover:shadow-md transition-shadow",children:n.jsx("div",{className:"p-6",children:k===w.id?n.jsxs(n.Fragment,{children:[n.jsx("input",{type:"text",value:S.code||"",onChange:m=>X("code",m.target.value),className:"w-full mb-2 px-3 py-2 border rounded-md dark:bg-gray-700",placeholder:"Course Code"}),n.jsx("input",{type:"text",value:S.name||"",onChange:m=>X("name",m.target.value),className:"w-full mb-2 px-3 py-2 border rounded-md dark:bg-gray-700",placeholder:"Course Name"}),n.jsx("select",{value:S.department||be[1],onChange:m=>X("department",m.target.value),className:"w-full mb-2 px-3 py-2 border rounded-md dark:bg-gray-700",children:be.slice(1).map(m=>n.jsx("option",{value:m,children:m},m))}),n.jsx("input",{type:"text",value:S.professor||"",onChange:m=>X("professor",m.target.value),className:"w-full mb-2 px-3 py-2 border rounded-md dark:bg-gray-700",placeholder:"Professor"}),n.jsx("textarea",{value:S.description||"",onChange:m=>X("description",m.target.value),className:"w-full mb-2 px-3 py-2 border rounded-md dark:bg-gray-700",placeholder:"Description"}),n.jsxs("div",{className:"flex space-x-2",children:[n.jsx("button",{onClick:Z,className:"px-4 py-2 bg-blue-600 text-white rounded-md",children:"Save"}),n.jsx("button",{onClick:U,className:"px-4 py-2 bg-gray-500 text-white rounded-md",children:"Cancel"})]})]}):n.jsxs(n.Fragment,{children:[n.jsx("h2",{className:"text-lg font-semibold",children:w.name}),n.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:[w.code," • ",w.department]}),n.jsx("p",{className:"text-sm mt-2",children:w.description}),n.jsxs("p",{className:"text-sm font-medium mt-2",children:["Instructor: ",w.professor]}),n.jsxs("div",{className:"flex items-center justify-between mt-4 pt-4 border-t dark:border-gray-700",children:[n.jsxs("div",{className:"flex items-center text-sm text-gray-600 dark:text-gray-300",children:[n.jsx(He,{size:16,className:"mr-1"}),w.studentCount," students enrolled"]}),n.jsxs("div",{className:"flex space-x-2",children:[f&&n.jsxs(W,{to:`/chat/${w.id}`,className:"px-3 py-1 text-sm rounded-md bg-blue-100 hover:bg-blue-200 dark:bg-blue-900 dark:hover:bg-blue-800 text-blue-800 dark:text-blue-200",children:[n.jsx(ce,{size:16,className:"mr-1 inline"}),"Chat"]}),t?n.jsxs(n.Fragment,{children:[n.jsx("button",{onClick:()=>q(w),className:"px-3 py-1 text-sm border border-green-500 text-green-600 hover:bg-green-50 dark:hover:bg-green-900 rounded-md",children:"Edit"}),n.jsx("button",{onClick:()=>M(w.id),className:"px-3 py-1 text-sm border border-red-500 text-red-600 hover:bg-red-50 dark:hover:bg-red-900 rounded-md",children:"Remove"})]}):n.jsx("button",{onClick:()=>oe(w.id,v),className:`px-3 py-1 text-sm rounded-md ${v?"bg-red-600 text-white hover:bg-red-700":"bg-green-600 text-white hover:bg-green-700"}`,children:v?"Unenroll":"Enroll"})]})]})]})})},w.id)};return n.jsxs("div",{className:"space-y-6 bg-white dark:bg-gray-900 min-h-screen p-6 text-gray-900 dark:text-white",children:[n.jsx("div",{className:"fixed top-0 right-0 z-50 space-y-2 p-4",children:x.map(w=>n.jsx(Ge,{message:w.message,type:w.type,onClose:()=>F(w.id)},w.id))}),n.jsx("h1",{className:"text-2xl font-bold",children:"Browse Courses"}),n.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[n.jsxs("div",{className:"relative flex-grow",children:[n.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:n.jsx(Xt,{size:18,className:"text-gray-400"})}),n.jsx("input",{type:"text",placeholder:"Search courses...",value:i,onChange:w=>a(w.target.value),className:"block w-full pl-10 pr-3 py-2 border rounded-md dark:bg-gray-800"})]}),n.jsxs("div",{className:"relative",children:[n.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:n.jsx(Yt,{size:18,className:"text-gray-400"})}),n.jsx("select",{value:c,onChange:w=>l(w.target.value),className:"block w-full pl-10 pr-10 py-2 border rounded-md dark:bg-gray-800",children:be.map(w=>n.jsx("option",{value:w,children:w},w))})]})]}),t&&n.jsxs("div",{children:[n.jsx("button",{onClick:()=>u(!d),className:"px-4 py-2 mb-4 bg-green-600 text-white rounded-md",children:d?"Cancel":"Add New Course"}),d&&n.jsxs("div",{className:"space-y-4 mb-6 bg-gray-100 dark:bg-gray-800 p-4 rounded-md",children:[n.jsx("input",{type:"text",placeholder:"Course Code",value:R.code,onChange:w=>I({...R,code:w.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-black dark:text-white placeholder-gray-400 dark:placeholder-gray-300"}),n.jsx("input",{type:"text",placeholder:"Course Name",value:R.name,onChange:w=>I({...R,name:w.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-black dark:text-white"}),n.jsx("select",{value:R.department,onChange:w=>I({...R,department:w.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-black dark:text-white",children:be.slice(1).map(w=>n.jsx("option",{value:w,children:w},w))}),n.jsx("input",{type:"text",placeholder:"Professor",value:R.professor,onChange:w=>I({...R,professor:w.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-black dark:text-white"}),n.jsx("textarea",{placeholder:"Description",value:R.description,onChange:w=>I({...R,description:w.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-black dark:text-white"}),n.jsx("button",{onClick:T,className:"px-4 py-2 bg-blue-600 text-white rounded-md",children:"Create Course"})]})]}),ie.length>0&&n.jsxs(n.Fragment,{children:[n.jsx("h2",{className:"text-xl font-semibold",children:"Your Courses"}),n.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:ie.map(w=>ae(w,!0))})]}),de.length>0&&n.jsxs(n.Fragment,{children:[n.jsx("h2",{className:"text-xl font-semibold pt-6",children:"Other Courses"}),n.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:de.map(w=>ae(w))})]}),ie.length===0&&de.length===0&&n.jsx("p",{className:"text-center text-gray-500 pt-10",children:"No courses found."})]})};class ge extends Error{constructor(e,t){const r=new.target.prototype;super(`${e}: Status code '${t}'`),this.statusCode=t,this.__proto__=r}}class mt extends Error{constructor(e="A timeout occurred."){const t=new.target.prototype;super(e),this.__proto__=t}}class te extends Error{constructor(e="An abort occurred."){const t=new.target.prototype;super(e),this.__proto__=t}}class Tn extends Error{constructor(e,t){const r=new.target.prototype;super(e),this.transport=t,this.errorType="UnsupportedTransportError",this.__proto__=r}}class Pn extends Error{constructor(e,t){const r=new.target.prototype;super(e),this.transport=t,this.errorType="DisabledTransportError",this.__proto__=r}}class In extends Error{constructor(e,t){const r=new.target.prototype;super(e),this.transport=t,this.errorType="FailedToStartTransportError",this.__proto__=r}}class Ft extends Error{constructor(e){const t=new.target.prototype;super(e),this.errorType="FailedToNegotiateWithServerError",this.__proto__=t}}class An extends Error{constructor(e,t){const r=new.target.prototype;super(e),this.innerErrors=t,this.__proto__=r}}class Ss{constructor(e,t,r){this.statusCode=e,this.statusText=t,this.content=r}}class Qe{get(e,t){return this.send({...t,method:"GET",url:e})}post(e,t){return this.send({...t,method:"POST",url:e})}delete(e,t){return this.send({...t,method:"DELETE",url:e})}getCookieString(e){return""}}var g;(function(s){s[s.Trace=0]="Trace",s[s.Debug=1]="Debug",s[s.Information=2]="Information",s[s.Warning=3]="Warning",s[s.Error=4]="Error",s[s.Critical=5]="Critical",s[s.None=6]="None"})(g||(g={}));class Re{constructor(){}log(e,t){}}Re.instance=new Re;const $n="8.0.7";class B{static isRequired(e,t){if(e==null)throw new Error(`The '${t}' argument is required.`)}static isNotEmpty(e,t){if(!e||e.match(/^\s*$/))throw new Error(`The '${t}' argument should not be empty.`)}static isIn(e,t,r){if(!(e in t))throw new Error(`Unknown ${r} value: ${e}.`)}}class L{static get isBrowser(){return!L.isNode&&typeof window=="object"&&typeof window.document=="object"}static get isWebWorker(){return!L.isNode&&typeof self=="object"&&"importScripts"in self}static get isReactNative(){return!L.isNode&&typeof window=="object"&&typeof window.document>"u"}static get isNode(){return typeof process<"u"&&process.release&&process.release.name==="node"}}function Te(s,e){let t="";return pe(s)?(t=`Binary data of length ${s.byteLength}`,e&&(t+=`. Content: '${On(s)}'`)):typeof s=="string"&&(t=`String data of length ${s.length}`,e&&(t+=`. Content: '${s}'`)),t}function On(s){const e=new Uint8Array(s);let t="";return e.forEach(r=>{const o=r<16?"0":"";t+=`0x${o}${r.toString(16)} `}),t.substr(0,t.length-1)}function pe(s){return s&&typeof ArrayBuffer<"u"&&(s instanceof ArrayBuffer||s.constructor&&s.constructor.name==="ArrayBuffer")}async function ks(s,e,t,r,o,i){const a={},[c,l]=we();a[c]=l,s.log(g.Trace,`(${e} transport) sending data. ${Te(o,i.logMessageContent)}.`);const d=pe(o)?"arraybuffer":"text",u=await t.post(r,{content:o,headers:{...a,...i.headers},responseType:d,timeout:i.timeout,withCredentials:i.withCredentials});s.log(g.Trace,`(${e} transport) request complete. Response status: ${u.statusCode}.`)}function Dn(s){return s===void 0?new Be(g.Information):s===null?Re.instance:s.log!==void 0?s:new Be(s)}class Un{constructor(e,t){this._subject=e,this._observer=t}dispose(){const e=this._subject.observers.indexOf(this._observer);e>-1&&this._subject.observers.splice(e,1),this._subject.observers.length===0&&this._subject.cancelCallback&&this._subject.cancelCallback().catch(t=>{})}}class Be{constructor(e){this._minLevel=e,this.out=console}log(e,t){if(e>=this._minLevel){const r=`[${new Date().toISOString()}] ${g[e]}: ${t}`;switch(e){case g.Critical:case g.Error:this.out.error(r);break;case g.Warning:this.out.warn(r);break;case g.Information:this.out.info(r);break;default:this.out.log(r);break}}}}function we(){let s="X-SignalR-User-Agent";return L.isNode&&(s="User-Agent"),[s,Fn($n,Mn(),qn(),Ln())]}function Fn(s,e,t,r){let o="Microsoft SignalR/";const i=s.split(".");return o+=`${i[0]}.${i[1]}`,o+=` (${s}; `,e&&e!==""?o+=`${e}; `:o+="Unknown OS; ",o+=`${t}`,r?o+=`; ${r}`:o+="; Unknown Runtime Version",o+=")",o}function Mn(){if(L.isNode)switch(process.platform){case"win32":return"Windows NT";case"darwin":return"macOS";case"linux":return"Linux";default:return process.platform}else return""}function Ln(){if(L.isNode)return process.versions.node}function qn(){return L.isNode?"NodeJS":"Browser"}function rt(s){return s.stack?s.stack:s.message?s.message:`${s}`}function Bn(){if(typeof globalThis<"u")return globalThis;if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("could not find global")}class Hn extends Qe{constructor(e){if(super(),this._logger=e,typeof fetch>"u"||L.isNode){const t=typeof __webpack_require__=="function"?__non_webpack_require__:require;this._jar=new(t("tough-cookie")).CookieJar,typeof fetch>"u"?this._fetchType=t("node-fetch"):this._fetchType=fetch,this._fetchType=t("fetch-cookie")(this._fetchType,this._jar)}else this._fetchType=fetch.bind(Bn());if(typeof AbortController>"u"){const t=typeof __webpack_require__=="function"?__non_webpack_require__:require;this._abortControllerType=t("abort-controller")}else this._abortControllerType=AbortController}async send(e){if(e.abortSignal&&e.abortSignal.aborted)throw new te;if(!e.method)throw new Error("No method defined.");if(!e.url)throw new Error("No url defined.");const t=new this._abortControllerType;let r;e.abortSignal&&(e.abortSignal.onabort=()=>{t.abort(),r=new te});let o=null;if(e.timeout){const l=e.timeout;o=setTimeout(()=>{t.abort(),this._logger.log(g.Warning,"Timeout from HTTP request."),r=new mt},l)}e.content===""&&(e.content=void 0),e.content&&(e.headers=e.headers||{},pe(e.content)?e.headers["Content-Type"]="application/octet-stream":e.headers["Content-Type"]="text/plain;charset=UTF-8");let i;try{i=await this._fetchType(e.url,{body:e.content,cache:"no-cache",credentials:e.withCredentials===!0?"include":"same-origin",headers:{"X-Requested-With":"XMLHttpRequest",...e.headers},method:e.method,mode:"cors",redirect:"follow",signal:t.signal})}catch(l){throw r||(this._logger.log(g.Warning,`Error from HTTP request. ${l}.`),l)}finally{o&&clearTimeout(o),e.abortSignal&&(e.abortSignal.onabort=null)}if(!i.ok){const l=await Mt(i,"text");throw new ge(l||i.statusText,i.status)}const c=await Mt(i,e.responseType);return new Ss(i.status,i.statusText,c)}getCookieString(e){let t="";return L.isNode&&this._jar&&this._jar.getCookies(e,(r,o)=>t=o.join("; ")),t}}function Mt(s,e){let t;switch(e){case"arraybuffer":t=s.arrayBuffer();break;case"text":t=s.text();break;case"blob":case"document":case"json":throw new Error(`${e} is not supported.`);default:t=s.text();break}return t}class zn extends Qe{constructor(e){super(),this._logger=e}send(e){return e.abortSignal&&e.abortSignal.aborted?Promise.reject(new te):e.method?e.url?new Promise((t,r)=>{const o=new XMLHttpRequest;o.open(e.method,e.url,!0),o.withCredentials=e.withCredentials===void 0?!0:e.withCredentials,o.setRequestHeader("X-Requested-With","XMLHttpRequest"),e.content===""&&(e.content=void 0),e.content&&(pe(e.content)?o.setRequestHeader("Content-Type","application/octet-stream"):o.setRequestHeader("Content-Type","text/plain;charset=UTF-8"));const i=e.headers;i&&Object.keys(i).forEach(a=>{o.setRequestHeader(a,i[a])}),e.responseType&&(o.responseType=e.responseType),e.abortSignal&&(e.abortSignal.onabort=()=>{o.abort(),r(new te)}),e.timeout&&(o.timeout=e.timeout),o.onload=()=>{e.abortSignal&&(e.abortSignal.onabort=null),o.status>=200&&o.status<300?t(new Ss(o.status,o.statusText,o.response||o.responseText)):r(new ge(o.response||o.responseText||o.statusText,o.status))},o.onerror=()=>{this._logger.log(g.Warning,`Error from HTTP request. ${o.status}: ${o.statusText}.`),r(new ge(o.statusText,o.status))},o.ontimeout=()=>{this._logger.log(g.Warning,"Timeout from HTTP request."),r(new mt)},o.send(e.content)}):Promise.reject(new Error("No url defined.")):Promise.reject(new Error("No method defined."))}}class Wn extends Qe{constructor(e){if(super(),typeof fetch<"u"||L.isNode)this._httpClient=new Hn(e);else if(typeof XMLHttpRequest<"u")this._httpClient=new zn(e);else throw new Error("No usable HttpClient found.")}send(e){return e.abortSignal&&e.abortSignal.aborted?Promise.reject(new te):e.method?e.url?this._httpClient.send(e):Promise.reject(new Error("No url defined.")):Promise.reject(new Error("No method defined."))}getCookieString(e){return this._httpClient.getCookieString(e)}}class Q{static write(e){return`${e}${Q.RecordSeparator}`}static parse(e){if(e[e.length-1]!==Q.RecordSeparator)throw new Error("Message is incomplete.");const t=e.split(Q.RecordSeparator);return t.pop(),t}}Q.RecordSeparatorCode=30;Q.RecordSeparator=String.fromCharCode(Q.RecordSeparatorCode);class Jn{writeHandshakeRequest(e){return Q.write(JSON.stringify(e))}parseHandshakeResponse(e){let t,r;if(pe(e)){const c=new Uint8Array(e),l=c.indexOf(Q.RecordSeparatorCode);if(l===-1)throw new Error("Message is incomplete.");const d=l+1;t=String.fromCharCode.apply(null,Array.prototype.slice.call(c.slice(0,d))),r=c.byteLength>d?c.slice(d).buffer:null}else{const c=e,l=c.indexOf(Q.RecordSeparator);if(l===-1)throw new Error("Message is incomplete.");const d=l+1;t=c.substring(0,d),r=c.length>d?c.substring(d):null}const o=Q.parse(t),i=JSON.parse(o[0]);if(i.type)throw new Error("Expected a handshake response from the server.");return[r,i]}}var A;(function(s){s[s.Invocation=1]="Invocation",s[s.StreamItem=2]="StreamItem",s[s.Completion=3]="Completion",s[s.StreamInvocation=4]="StreamInvocation",s[s.CancelInvocation=5]="CancelInvocation",s[s.Ping=6]="Ping",s[s.Close=7]="Close",s[s.Ack=8]="Ack",s[s.Sequence=9]="Sequence"})(A||(A={}));class Vn{constructor(){this.observers=[]}next(e){for(const t of this.observers)t.next(e)}error(e){for(const t of this.observers)t.error&&t.error(e)}complete(){for(const e of this.observers)e.complete&&e.complete()}subscribe(e){return this.observers.push(e),new Un(this,e)}}class Kn{constructor(e,t,r){this._bufferSize=1e5,this._messages=[],this._totalMessageCount=0,this._waitForSequenceMessage=!1,this._nextReceivingSequenceId=1,this._latestReceivedSequenceId=0,this._bufferedByteCount=0,this._reconnectInProgress=!1,this._protocol=e,this._connection=t,this._bufferSize=r}async _send(e){const t=this._protocol.writeMessage(e);let r=Promise.resolve();if(this._isInvocationMessage(e)){this._totalMessageCount++;let o=()=>{},i=()=>{};pe(t)?this._bufferedByteCount+=t.byteLength:this._bufferedByteCount+=t.length,this._bufferedByteCount>=this._bufferSize&&(r=new Promise((a,c)=>{o=a,i=c})),this._messages.push(new Xn(t,this._totalMessageCount,o,i))}try{this._reconnectInProgress||await this._connection.send(t)}catch{this._disconnected()}await r}_ack(e){let t=-1;for(let r=0;r<this._messages.length;r++){const o=this._messages[r];if(o._id<=e.sequenceId)t=r,pe(o._message)?this._bufferedByteCount-=o._message.byteLength:this._bufferedByteCount-=o._message.length,o._resolver();else if(this._bufferedByteCount<this._bufferSize)o._resolver();else break}t!==-1&&(this._messages=this._messages.slice(t+1))}_shouldProcessMessage(e){if(this._waitForSequenceMessage)return e.type!==A.Sequence?!1:(this._waitForSequenceMessage=!1,!0);if(!this._isInvocationMessage(e))return!0;const t=this._nextReceivingSequenceId;return this._nextReceivingSequenceId++,t<=this._latestReceivedSequenceId?(t===this._latestReceivedSequenceId&&this._ackTimer(),!1):(this._latestReceivedSequenceId=t,this._ackTimer(),!0)}_resetSequence(e){if(e.sequenceId>this._nextReceivingSequenceId){this._connection.stop(new Error("Sequence ID greater than amount of messages we've received."));return}this._nextReceivingSequenceId=e.sequenceId}_disconnected(){this._reconnectInProgress=!0,this._waitForSequenceMessage=!0}async _resend(){const e=this._messages.length!==0?this._messages[0]._id:this._totalMessageCount+1;await this._connection.send(this._protocol.writeMessage({type:A.Sequence,sequenceId:e}));const t=this._messages;for(const r of t)await this._connection.send(r._message);this._reconnectInProgress=!1}_dispose(e){e??(e=new Error("Unable to reconnect to server."));for(const t of this._messages)t._rejector(e)}_isInvocationMessage(e){switch(e.type){case A.Invocation:case A.StreamItem:case A.Completion:case A.StreamInvocation:case A.CancelInvocation:return!0;case A.Close:case A.Sequence:case A.Ping:case A.Ack:return!1}}_ackTimer(){this._ackTimerHandle===void 0&&(this._ackTimerHandle=setTimeout(async()=>{try{this._reconnectInProgress||await this._connection.send(this._protocol.writeMessage({type:A.Ack,sequenceId:this._latestReceivedSequenceId}))}catch{}clearTimeout(this._ackTimerHandle),this._ackTimerHandle=void 0},1e3))}}class Xn{constructor(e,t,r,o){this._message=e,this._id=t,this._resolver=r,this._rejector=o}}const Yn=30*1e3,Gn=15*1e3,Qn=1e5;var D;(function(s){s.Disconnected="Disconnected",s.Connecting="Connecting",s.Connected="Connected",s.Disconnecting="Disconnecting",s.Reconnecting="Reconnecting"})(D||(D={}));class pt{static create(e,t,r,o,i,a,c){return new pt(e,t,r,o,i,a,c)}constructor(e,t,r,o,i,a,c){this._nextKeepAlive=0,this._freezeEventListener=()=>{this._logger.log(g.Warning,"The page is being frozen, this will likely lead to the connection being closed and messages being lost. For more information see the docs at https://learn.microsoft.com/aspnet/core/signalr/javascript-client#bsleep")},B.isRequired(e,"connection"),B.isRequired(t,"logger"),B.isRequired(r,"protocol"),this.serverTimeoutInMilliseconds=i??Yn,this.keepAliveIntervalInMilliseconds=a??Gn,this._statefulReconnectBufferSize=c??Qn,this._logger=t,this._protocol=r,this.connection=e,this._reconnectPolicy=o,this._handshakeProtocol=new Jn,this.connection.onreceive=l=>this._processIncomingData(l),this.connection.onclose=l=>this._connectionClosed(l),this._callbacks={},this._methods={},this._closedCallbacks=[],this._reconnectingCallbacks=[],this._reconnectedCallbacks=[],this._invocationId=0,this._receivedHandshakeResponse=!1,this._connectionState=D.Disconnected,this._connectionStarted=!1,this._cachedPingMessage=this._protocol.writeMessage({type:A.Ping})}get state(){return this._connectionState}get connectionId(){return this.connection&&this.connection.connectionId||null}get baseUrl(){return this.connection.baseUrl||""}set baseUrl(e){if(this._connectionState!==D.Disconnected&&this._connectionState!==D.Reconnecting)throw new Error("The HubConnection must be in the Disconnected or Reconnecting state to change the url.");if(!e)throw new Error("The HubConnection url must be a valid url.");this.connection.baseUrl=e}start(){return this._startPromise=this._startWithStateTransitions(),this._startPromise}async _startWithStateTransitions(){if(this._connectionState!==D.Disconnected)return Promise.reject(new Error("Cannot start a HubConnection that is not in the 'Disconnected' state."));this._connectionState=D.Connecting,this._logger.log(g.Debug,"Starting HubConnection.");try{await this._startInternal(),L.isBrowser&&window.document.addEventListener("freeze",this._freezeEventListener),this._connectionState=D.Connected,this._connectionStarted=!0,this._logger.log(g.Debug,"HubConnection connected successfully.")}catch(e){return this._connectionState=D.Disconnected,this._logger.log(g.Debug,`HubConnection failed to start successfully because of error '${e}'.`),Promise.reject(e)}}async _startInternal(){this._stopDuringStartError=void 0,this._receivedHandshakeResponse=!1;const e=new Promise((t,r)=>{this._handshakeResolver=t,this._handshakeRejecter=r});await this.connection.start(this._protocol.transferFormat);try{let t=this._protocol.version;this.connection.features.reconnect||(t=1);const r={protocol:this._protocol.name,version:t};if(this._logger.log(g.Debug,"Sending handshake request."),await this._sendMessage(this._handshakeProtocol.writeHandshakeRequest(r)),this._logger.log(g.Information,`Using HubProtocol '${this._protocol.name}'.`),this._cleanupTimeout(),this._resetTimeoutPeriod(),this._resetKeepAliveInterval(),await e,this._stopDuringStartError)throw this._stopDuringStartError;(this.connection.features.reconnect||!1)&&(this._messageBuffer=new Kn(this._protocol,this.connection,this._statefulReconnectBufferSize),this.connection.features.disconnected=this._messageBuffer._disconnected.bind(this._messageBuffer),this.connection.features.resend=()=>{if(this._messageBuffer)return this._messageBuffer._resend()}),this.connection.features.inherentKeepAlive||await this._sendMessage(this._cachedPingMessage)}catch(t){throw this._logger.log(g.Debug,`Hub handshake failed with error '${t}' during start(). Stopping HubConnection.`),this._cleanupTimeout(),this._cleanupPingTimer(),await this.connection.stop(t),t}}async stop(){const e=this._startPromise;this.connection.features.reconnect=!1,this._stopPromise=this._stopInternal(),await this._stopPromise;try{await e}catch{}}_stopInternal(e){if(this._connectionState===D.Disconnected)return this._logger.log(g.Debug,`Call to HubConnection.stop(${e}) ignored because it is already in the disconnected state.`),Promise.resolve();if(this._connectionState===D.Disconnecting)return this._logger.log(g.Debug,`Call to HttpConnection.stop(${e}) ignored because the connection is already in the disconnecting state.`),this._stopPromise;const t=this._connectionState;return this._connectionState=D.Disconnecting,this._logger.log(g.Debug,"Stopping HubConnection."),this._reconnectDelayHandle?(this._logger.log(g.Debug,"Connection stopped during reconnect delay. Done reconnecting."),clearTimeout(this._reconnectDelayHandle),this._reconnectDelayHandle=void 0,this._completeClose(),Promise.resolve()):(t===D.Connected&&this._sendCloseMessage(),this._cleanupTimeout(),this._cleanupPingTimer(),this._stopDuringStartError=e||new te("The connection was stopped before the hub handshake could complete."),this.connection.stop(e))}async _sendCloseMessage(){try{await this._sendWithProtocol(this._createCloseMessage())}catch{}}stream(e,...t){const[r,o]=this._replaceStreamingParams(t),i=this._createStreamInvocation(e,t,o);let a;const c=new Vn;return c.cancelCallback=()=>{const l=this._createCancelInvocation(i.invocationId);return delete this._callbacks[i.invocationId],a.then(()=>this._sendWithProtocol(l))},this._callbacks[i.invocationId]=(l,d)=>{if(d){c.error(d);return}else l&&(l.type===A.Completion?l.error?c.error(new Error(l.error)):c.complete():c.next(l.item))},a=this._sendWithProtocol(i).catch(l=>{c.error(l),delete this._callbacks[i.invocationId]}),this._launchStreams(r,a),c}_sendMessage(e){return this._resetKeepAliveInterval(),this.connection.send(e)}_sendWithProtocol(e){return this._messageBuffer?this._messageBuffer._send(e):this._sendMessage(this._protocol.writeMessage(e))}send(e,...t){const[r,o]=this._replaceStreamingParams(t),i=this._sendWithProtocol(this._createInvocation(e,t,!0,o));return this._launchStreams(r,i),i}invoke(e,...t){const[r,o]=this._replaceStreamingParams(t),i=this._createInvocation(e,t,!1,o);return new Promise((c,l)=>{this._callbacks[i.invocationId]=(u,b)=>{if(b){l(b);return}else u&&(u.type===A.Completion?u.error?l(new Error(u.error)):c(u.result):l(new Error(`Unexpected message type: ${u.type}`)))};const d=this._sendWithProtocol(i).catch(u=>{l(u),delete this._callbacks[i.invocationId]});this._launchStreams(r,d)})}on(e,t){!e||!t||(e=e.toLowerCase(),this._methods[e]||(this._methods[e]=[]),this._methods[e].indexOf(t)===-1&&this._methods[e].push(t))}off(e,t){if(!e)return;e=e.toLowerCase();const r=this._methods[e];if(r)if(t){const o=r.indexOf(t);o!==-1&&(r.splice(o,1),r.length===0&&delete this._methods[e])}else delete this._methods[e]}onclose(e){e&&this._closedCallbacks.push(e)}onreconnecting(e){e&&this._reconnectingCallbacks.push(e)}onreconnected(e){e&&this._reconnectedCallbacks.push(e)}_processIncomingData(e){if(this._cleanupTimeout(),this._receivedHandshakeResponse||(e=this._processHandshakeResponse(e),this._receivedHandshakeResponse=!0),e){const t=this._protocol.parseMessages(e,this._logger);for(const r of t)if(!(this._messageBuffer&&!this._messageBuffer._shouldProcessMessage(r)))switch(r.type){case A.Invocation:this._invokeClientMethod(r).catch(o=>{this._logger.log(g.Error,`Invoke client method threw error: ${rt(o)}`)});break;case A.StreamItem:case A.Completion:{const o=this._callbacks[r.invocationId];if(o){r.type===A.Completion&&delete this._callbacks[r.invocationId];try{o(r)}catch(i){this._logger.log(g.Error,`Stream callback threw error: ${rt(i)}`)}}break}case A.Ping:break;case A.Close:{this._logger.log(g.Information,"Close message received from server.");const o=r.error?new Error("Server returned an error on close: "+r.error):void 0;r.allowReconnect===!0?this.connection.stop(o):this._stopPromise=this._stopInternal(o);break}case A.Ack:this._messageBuffer&&this._messageBuffer._ack(r);break;case A.Sequence:this._messageBuffer&&this._messageBuffer._resetSequence(r);break;default:this._logger.log(g.Warning,`Invalid message type: ${r.type}.`);break}}this._resetTimeoutPeriod()}_processHandshakeResponse(e){let t,r;try{[r,t]=this._handshakeProtocol.parseHandshakeResponse(e)}catch(o){const i="Error parsing handshake response: "+o;this._logger.log(g.Error,i);const a=new Error(i);throw this._handshakeRejecter(a),a}if(t.error){const o="Server returned handshake error: "+t.error;this._logger.log(g.Error,o);const i=new Error(o);throw this._handshakeRejecter(i),i}else this._logger.log(g.Debug,"Server handshake complete.");return this._handshakeResolver(),r}_resetKeepAliveInterval(){this.connection.features.inherentKeepAlive||(this._nextKeepAlive=new Date().getTime()+this.keepAliveIntervalInMilliseconds,this._cleanupPingTimer())}_resetTimeoutPeriod(){if((!this.connection.features||!this.connection.features.inherentKeepAlive)&&(this._timeoutHandle=setTimeout(()=>this.serverTimeout(),this.serverTimeoutInMilliseconds),this._pingServerHandle===void 0)){let e=this._nextKeepAlive-new Date().getTime();e<0&&(e=0),this._pingServerHandle=setTimeout(async()=>{if(this._connectionState===D.Connected)try{await this._sendMessage(this._cachedPingMessage)}catch{this._cleanupPingTimer()}},e)}}serverTimeout(){this.connection.stop(new Error("Server timeout elapsed without receiving a message from the server."))}async _invokeClientMethod(e){const t=e.target.toLowerCase(),r=this._methods[t];if(!r){this._logger.log(g.Warning,`No client method with the name '${t}' found.`),e.invocationId&&(this._logger.log(g.Warning,`No result given for '${t}' method and invocation ID '${e.invocationId}'.`),await this._sendWithProtocol(this._createCompletionMessage(e.invocationId,"Client didn't provide a result.",null)));return}const o=r.slice(),i=!!e.invocationId;let a,c,l;for(const d of o)try{const u=a;a=await d.apply(this,e.arguments),i&&a&&u&&(this._logger.log(g.Error,`Multiple results provided for '${t}'. Sending error to server.`),l=this._createCompletionMessage(e.invocationId,"Client provided multiple results.",null)),c=void 0}catch(u){c=u,this._logger.log(g.Error,`A callback for the method '${t}' threw error '${u}'.`)}l?await this._sendWithProtocol(l):i?(c?l=this._createCompletionMessage(e.invocationId,`${c}`,null):a!==void 0?l=this._createCompletionMessage(e.invocationId,null,a):(this._logger.log(g.Warning,`No result given for '${t}' method and invocation ID '${e.invocationId}'.`),l=this._createCompletionMessage(e.invocationId,"Client didn't provide a result.",null)),await this._sendWithProtocol(l)):a&&this._logger.log(g.Error,`Result given for '${t}' method but server is not expecting a result.`)}_connectionClosed(e){this._logger.log(g.Debug,`HubConnection.connectionClosed(${e}) called while in state ${this._connectionState}.`),this._stopDuringStartError=this._stopDuringStartError||e||new te("The underlying connection was closed before the hub handshake could complete."),this._handshakeResolver&&this._handshakeResolver(),this._cancelCallbacksWithError(e||new Error("Invocation canceled due to the underlying connection being closed.")),this._cleanupTimeout(),this._cleanupPingTimer(),this._connectionState===D.Disconnecting?this._completeClose(e):this._connectionState===D.Connected&&this._reconnectPolicy?this._reconnect(e):this._connectionState===D.Connected&&this._completeClose(e)}_completeClose(e){if(this._connectionStarted){this._connectionState=D.Disconnected,this._connectionStarted=!1,this._messageBuffer&&(this._messageBuffer._dispose(e??new Error("Connection closed.")),this._messageBuffer=void 0),L.isBrowser&&window.document.removeEventListener("freeze",this._freezeEventListener);try{this._closedCallbacks.forEach(t=>t.apply(this,[e]))}catch(t){this._logger.log(g.Error,`An onclose callback called with error '${e}' threw error '${t}'.`)}}}async _reconnect(e){const t=Date.now();let r=0,o=e!==void 0?e:new Error("Attempting to reconnect due to a unknown error."),i=this._getNextRetryDelay(r++,0,o);if(i===null){this._logger.log(g.Debug,"Connection not reconnecting because the IRetryPolicy returned null on the first reconnect attempt."),this._completeClose(e);return}if(this._connectionState=D.Reconnecting,e?this._logger.log(g.Information,`Connection reconnecting because of error '${e}'.`):this._logger.log(g.Information,"Connection reconnecting."),this._reconnectingCallbacks.length!==0){try{this._reconnectingCallbacks.forEach(a=>a.apply(this,[e]))}catch(a){this._logger.log(g.Error,`An onreconnecting callback called with error '${e}' threw error '${a}'.`)}if(this._connectionState!==D.Reconnecting){this._logger.log(g.Debug,"Connection left the reconnecting state in onreconnecting callback. Done reconnecting.");return}}for(;i!==null;){if(this._logger.log(g.Information,`Reconnect attempt number ${r} will start in ${i} ms.`),await new Promise(a=>{this._reconnectDelayHandle=setTimeout(a,i)}),this._reconnectDelayHandle=void 0,this._connectionState!==D.Reconnecting){this._logger.log(g.Debug,"Connection left the reconnecting state during reconnect delay. Done reconnecting.");return}try{if(await this._startInternal(),this._connectionState=D.Connected,this._logger.log(g.Information,"HubConnection reconnected successfully."),this._reconnectedCallbacks.length!==0)try{this._reconnectedCallbacks.forEach(a=>a.apply(this,[this.connection.connectionId]))}catch(a){this._logger.log(g.Error,`An onreconnected callback called with connectionId '${this.connection.connectionId}; threw error '${a}'.`)}return}catch(a){if(this._logger.log(g.Information,`Reconnect attempt failed because of error '${a}'.`),this._connectionState!==D.Reconnecting){this._logger.log(g.Debug,`Connection moved to the '${this._connectionState}' from the reconnecting state during reconnect attempt. Done reconnecting.`),this._connectionState===D.Disconnecting&&this._completeClose();return}o=a instanceof Error?a:new Error(a.toString()),i=this._getNextRetryDelay(r++,Date.now()-t,o)}}this._logger.log(g.Information,`Reconnect retries have been exhausted after ${Date.now()-t} ms and ${r} failed attempts. Connection disconnecting.`),this._completeClose()}_getNextRetryDelay(e,t,r){try{return this._reconnectPolicy.nextRetryDelayInMilliseconds({elapsedMilliseconds:t,previousRetryCount:e,retryReason:r})}catch(o){return this._logger.log(g.Error,`IRetryPolicy.nextRetryDelayInMilliseconds(${e}, ${t}) threw error '${o}'.`),null}}_cancelCallbacksWithError(e){const t=this._callbacks;this._callbacks={},Object.keys(t).forEach(r=>{const o=t[r];try{o(null,e)}catch(i){this._logger.log(g.Error,`Stream 'error' callback called with '${e}' threw error: ${rt(i)}`)}})}_cleanupPingTimer(){this._pingServerHandle&&(clearTimeout(this._pingServerHandle),this._pingServerHandle=void 0)}_cleanupTimeout(){this._timeoutHandle&&clearTimeout(this._timeoutHandle)}_createInvocation(e,t,r,o){if(r)return o.length!==0?{arguments:t,streamIds:o,target:e,type:A.Invocation}:{arguments:t,target:e,type:A.Invocation};{const i=this._invocationId;return this._invocationId++,o.length!==0?{arguments:t,invocationId:i.toString(),streamIds:o,target:e,type:A.Invocation}:{arguments:t,invocationId:i.toString(),target:e,type:A.Invocation}}}_launchStreams(e,t){if(e.length!==0){t||(t=Promise.resolve());for(const r in e)e[r].subscribe({complete:()=>{t=t.then(()=>this._sendWithProtocol(this._createCompletionMessage(r)))},error:o=>{let i;o instanceof Error?i=o.message:o&&o.toString?i=o.toString():i="Unknown error",t=t.then(()=>this._sendWithProtocol(this._createCompletionMessage(r,i)))},next:o=>{t=t.then(()=>this._sendWithProtocol(this._createStreamItemMessage(r,o)))}})}}_replaceStreamingParams(e){const t=[],r=[];for(let o=0;o<e.length;o++){const i=e[o];if(this._isObservable(i)){const a=this._invocationId;this._invocationId++,t[a]=i,r.push(a.toString()),e.splice(o,1)}}return[t,r]}_isObservable(e){return e&&e.subscribe&&typeof e.subscribe=="function"}_createStreamInvocation(e,t,r){const o=this._invocationId;return this._invocationId++,r.length!==0?{arguments:t,invocationId:o.toString(),streamIds:r,target:e,type:A.StreamInvocation}:{arguments:t,invocationId:o.toString(),target:e,type:A.StreamInvocation}}_createCancelInvocation(e){return{invocationId:e,type:A.CancelInvocation}}_createStreamItemMessage(e,t){return{invocationId:e,item:t,type:A.StreamItem}}_createCompletionMessage(e,t,r){return t?{error:t,invocationId:e,type:A.Completion}:{invocationId:e,result:r,type:A.Completion}}_createCloseMessage(){return{type:A.Close}}}const Zn=[0,2e3,1e4,3e4,null];class Lt{constructor(e){this._retryDelays=e!==void 0?[...e,null]:Zn}nextRetryDelayInMilliseconds(e){return this._retryDelays[e.previousRetryCount]}}class fe{}fe.Authorization="Authorization";fe.Cookie="Cookie";class eo extends Qe{constructor(e,t){super(),this._innerClient=e,this._accessTokenFactory=t}async send(e){let t=!0;this._accessTokenFactory&&(!this._accessToken||e.url&&e.url.indexOf("/negotiate?")>0)&&(t=!1,this._accessToken=await this._accessTokenFactory()),this._setAuthorizationHeader(e);const r=await this._innerClient.send(e);return t&&r.statusCode===401&&this._accessTokenFactory?(this._accessToken=await this._accessTokenFactory(),this._setAuthorizationHeader(e),await this._innerClient.send(e)):r}_setAuthorizationHeader(e){e.headers||(e.headers={}),this._accessToken?e.headers[fe.Authorization]=`Bearer ${this._accessToken}`:this._accessTokenFactory&&e.headers[fe.Authorization]&&delete e.headers[fe.Authorization]}getCookieString(e){return this._innerClient.getCookieString(e)}}var z;(function(s){s[s.None=0]="None",s[s.WebSockets=1]="WebSockets",s[s.ServerSentEvents=2]="ServerSentEvents",s[s.LongPolling=4]="LongPolling"})(z||(z={}));var J;(function(s){s[s.Text=1]="Text",s[s.Binary=2]="Binary"})(J||(J={}));let to=class{constructor(){this._isAborted=!1,this.onabort=null}abort(){this._isAborted||(this._isAborted=!0,this.onabort&&this.onabort())}get signal(){return this}get aborted(){return this._isAborted}};class qt{get pollAborted(){return this._pollAbort.aborted}constructor(e,t,r){this._httpClient=e,this._logger=t,this._pollAbort=new to,this._options=r,this._running=!1,this.onreceive=null,this.onclose=null}async connect(e,t){if(B.isRequired(e,"url"),B.isRequired(t,"transferFormat"),B.isIn(t,J,"transferFormat"),this._url=e,this._logger.log(g.Trace,"(LongPolling transport) Connecting."),t===J.Binary&&typeof XMLHttpRequest<"u"&&typeof new XMLHttpRequest().responseType!="string")throw new Error("Binary protocols over XmlHttpRequest not implementing advanced features are not supported.");const[r,o]=we(),i={[r]:o,...this._options.headers},a={abortSignal:this._pollAbort.signal,headers:i,timeout:1e5,withCredentials:this._options.withCredentials};t===J.Binary&&(a.responseType="arraybuffer");const c=`${e}&_=${Date.now()}`;this._logger.log(g.Trace,`(LongPolling transport) polling: ${c}.`);const l=await this._httpClient.get(c,a);l.statusCode!==200?(this._logger.log(g.Error,`(LongPolling transport) Unexpected response code: ${l.statusCode}.`),this._closeError=new ge(l.statusText||"",l.statusCode),this._running=!1):this._running=!0,this._receiving=this._poll(this._url,a)}async _poll(e,t){try{for(;this._running;)try{const r=`${e}&_=${Date.now()}`;this._logger.log(g.Trace,`(LongPolling transport) polling: ${r}.`);const o=await this._httpClient.get(r,t);o.statusCode===204?(this._logger.log(g.Information,"(LongPolling transport) Poll terminated by server."),this._running=!1):o.statusCode!==200?(this._logger.log(g.Error,`(LongPolling transport) Unexpected response code: ${o.statusCode}.`),this._closeError=new ge(o.statusText||"",o.statusCode),this._running=!1):o.content?(this._logger.log(g.Trace,`(LongPolling transport) data received. ${Te(o.content,this._options.logMessageContent)}.`),this.onreceive&&this.onreceive(o.content)):this._logger.log(g.Trace,"(LongPolling transport) Poll timed out, reissuing.")}catch(r){this._running?r instanceof mt?this._logger.log(g.Trace,"(LongPolling transport) Poll timed out, reissuing."):(this._closeError=r,this._running=!1):this._logger.log(g.Trace,`(LongPolling transport) Poll errored after shutdown: ${r.message}`)}}finally{this._logger.log(g.Trace,"(LongPolling transport) Polling complete."),this.pollAborted||this._raiseOnClose()}}async send(e){return this._running?ks(this._logger,"LongPolling",this._httpClient,this._url,e,this._options):Promise.reject(new Error("Cannot send until the transport is connected"))}async stop(){this._logger.log(g.Trace,"(LongPolling transport) Stopping polling."),this._running=!1,this._pollAbort.abort();try{await this._receiving,this._logger.log(g.Trace,`(LongPolling transport) sending DELETE request to ${this._url}.`);const e={},[t,r]=we();e[t]=r;const o={headers:{...e,...this._options.headers},timeout:this._options.timeout,withCredentials:this._options.withCredentials};let i;try{await this._httpClient.delete(this._url,o)}catch(a){i=a}i?i instanceof ge&&(i.statusCode===404?this._logger.log(g.Trace,"(LongPolling transport) A 404 response was returned from sending a DELETE request."):this._logger.log(g.Trace,`(LongPolling transport) Error sending a DELETE request: ${i}`)):this._logger.log(g.Trace,"(LongPolling transport) DELETE request accepted.")}finally{this._logger.log(g.Trace,"(LongPolling transport) Stop finished."),this._raiseOnClose()}}_raiseOnClose(){if(this.onclose){let e="(LongPolling transport) Firing onclose event.";this._closeError&&(e+=" Error: "+this._closeError),this._logger.log(g.Trace,e),this.onclose(this._closeError)}}}class so{constructor(e,t,r,o){this._httpClient=e,this._accessToken=t,this._logger=r,this._options=o,this.onreceive=null,this.onclose=null}async connect(e,t){return B.isRequired(e,"url"),B.isRequired(t,"transferFormat"),B.isIn(t,J,"transferFormat"),this._logger.log(g.Trace,"(SSE transport) Connecting."),this._url=e,this._accessToken&&(e+=(e.indexOf("?")<0?"?":"&")+`access_token=${encodeURIComponent(this._accessToken)}`),new Promise((r,o)=>{let i=!1;if(t!==J.Text){o(new Error("The Server-Sent Events transport only supports the 'Text' transfer format"));return}let a;if(L.isBrowser||L.isWebWorker)a=new this._options.EventSource(e,{withCredentials:this._options.withCredentials});else{const c=this._httpClient.getCookieString(e),l={};l.Cookie=c;const[d,u]=we();l[d]=u,a=new this._options.EventSource(e,{withCredentials:this._options.withCredentials,headers:{...l,...this._options.headers}})}try{a.onmessage=c=>{if(this.onreceive)try{this._logger.log(g.Trace,`(SSE transport) data received. ${Te(c.data,this._options.logMessageContent)}.`),this.onreceive(c.data)}catch(l){this._close(l);return}},a.onerror=c=>{i?this._close():o(new Error("EventSource failed to connect. The connection could not be found on the server, either the connection ID is not present on the server, or a proxy is refusing/buffering the connection. If you have multiple servers check that sticky sessions are enabled."))},a.onopen=()=>{this._logger.log(g.Information,`SSE connected to ${this._url}`),this._eventSource=a,i=!0,r()}}catch(c){o(c);return}})}async send(e){return this._eventSource?ks(this._logger,"SSE",this._httpClient,this._url,e,this._options):Promise.reject(new Error("Cannot send until the transport is connected"))}stop(){return this._close(),Promise.resolve()}_close(e){this._eventSource&&(this._eventSource.close(),this._eventSource=void 0,this.onclose&&this.onclose(e))}}class ro{constructor(e,t,r,o,i,a){this._logger=r,this._accessTokenFactory=t,this._logMessageContent=o,this._webSocketConstructor=i,this._httpClient=e,this.onreceive=null,this.onclose=null,this._headers=a}async connect(e,t){B.isRequired(e,"url"),B.isRequired(t,"transferFormat"),B.isIn(t,J,"transferFormat"),this._logger.log(g.Trace,"(WebSockets transport) Connecting.");let r;return this._accessTokenFactory&&(r=await this._accessTokenFactory()),new Promise((o,i)=>{e=e.replace(/^http/,"ws");let a;const c=this._httpClient.getCookieString(e);let l=!1;if(L.isNode||L.isReactNative){const d={},[u,b]=we();d[u]=b,r&&(d[fe.Authorization]=`Bearer ${r}`),c&&(d[fe.Cookie]=c),a=new this._webSocketConstructor(e,void 0,{headers:{...d,...this._headers}})}else r&&(e+=(e.indexOf("?")<0?"?":"&")+`access_token=${encodeURIComponent(r)}`);a||(a=new this._webSocketConstructor(e)),t===J.Binary&&(a.binaryType="arraybuffer"),a.onopen=d=>{this._logger.log(g.Information,`WebSocket connected to ${e}.`),this._webSocket=a,l=!0,o()},a.onerror=d=>{let u=null;typeof ErrorEvent<"u"&&d instanceof ErrorEvent?u=d.error:u="There was an error with the transport",this._logger.log(g.Information,`(WebSockets transport) ${u}.`)},a.onmessage=d=>{if(this._logger.log(g.Trace,`(WebSockets transport) data received. ${Te(d.data,this._logMessageContent)}.`),this.onreceive)try{this.onreceive(d.data)}catch(u){this._close(u);return}},a.onclose=d=>{if(l)this._close(d);else{let u=null;typeof ErrorEvent<"u"&&d instanceof ErrorEvent?u=d.error:u="WebSocket failed to connect. The connection could not be found on the server, either the endpoint may not be a SignalR endpoint, the connection ID is not present on the server, or there is a proxy blocking WebSockets. If you have multiple servers check that sticky sessions are enabled.",i(new Error(u))}}})}send(e){return this._webSocket&&this._webSocket.readyState===this._webSocketConstructor.OPEN?(this._logger.log(g.Trace,`(WebSockets transport) sending data. ${Te(e,this._logMessageContent)}.`),this._webSocket.send(e),Promise.resolve()):Promise.reject("WebSocket is not in the OPEN state")}stop(){return this._webSocket&&this._close(void 0),Promise.resolve()}_close(e){this._webSocket&&(this._webSocket.onclose=()=>{},this._webSocket.onmessage=()=>{},this._webSocket.onerror=()=>{},this._webSocket.close(),this._webSocket=void 0),this._logger.log(g.Trace,"(WebSockets transport) socket closed."),this.onclose&&(this._isCloseEvent(e)&&(e.wasClean===!1||e.code!==1e3)?this.onclose(new Error(`WebSocket closed with status code: ${e.code} (${e.reason||"no reason given"}).`)):e instanceof Error?this.onclose(e):this.onclose())}_isCloseEvent(e){return e&&typeof e.wasClean=="boolean"&&typeof e.code=="number"}}const Bt=100;class no{constructor(e,t={}){if(this._stopPromiseResolver=()=>{},this.features={},this._negotiateVersion=1,B.isRequired(e,"url"),this._logger=Dn(t.logger),this.baseUrl=this._resolveUrl(e),t=t||{},t.logMessageContent=t.logMessageContent===void 0?!1:t.logMessageContent,typeof t.withCredentials=="boolean"||t.withCredentials===void 0)t.withCredentials=t.withCredentials===void 0?!0:t.withCredentials;else throw new Error("withCredentials option was not a 'boolean' or 'undefined' value");t.timeout=t.timeout===void 0?100*1e3:t.timeout;let r=null,o=null;if(L.isNode&&typeof require<"u"){const i=typeof __webpack_require__=="function"?__non_webpack_require__:require;r=i("ws"),o=i("eventsource")}!L.isNode&&typeof WebSocket<"u"&&!t.WebSocket?t.WebSocket=WebSocket:L.isNode&&!t.WebSocket&&r&&(t.WebSocket=r),!L.isNode&&typeof EventSource<"u"&&!t.EventSource?t.EventSource=EventSource:L.isNode&&!t.EventSource&&typeof o<"u"&&(t.EventSource=o),this._httpClient=new eo(t.httpClient||new Wn(this._logger),t.accessTokenFactory),this._connectionState="Disconnected",this._connectionStarted=!1,this._options=t,this.onreceive=null,this.onclose=null}async start(e){if(e=e||J.Binary,B.isIn(e,J,"transferFormat"),this._logger.log(g.Debug,`Starting connection with transfer format '${J[e]}'.`),this._connectionState!=="Disconnected")return Promise.reject(new Error("Cannot start an HttpConnection that is not in the 'Disconnected' state."));if(this._connectionState="Connecting",this._startInternalPromise=this._startInternal(e),await this._startInternalPromise,this._connectionState==="Disconnecting"){const t="Failed to start the HttpConnection before stop() was called.";return this._logger.log(g.Error,t),await this._stopPromise,Promise.reject(new te(t))}else if(this._connectionState!=="Connected"){const t="HttpConnection.startInternal completed gracefully but didn't enter the connection into the connected state!";return this._logger.log(g.Error,t),Promise.reject(new te(t))}this._connectionStarted=!0}send(e){return this._connectionState!=="Connected"?Promise.reject(new Error("Cannot send data if the connection is not in the 'Connected' State.")):(this._sendQueue||(this._sendQueue=new xt(this.transport)),this._sendQueue.send(e))}async stop(e){if(this._connectionState==="Disconnected")return this._logger.log(g.Debug,`Call to HttpConnection.stop(${e}) ignored because the connection is already in the disconnected state.`),Promise.resolve();if(this._connectionState==="Disconnecting")return this._logger.log(g.Debug,`Call to HttpConnection.stop(${e}) ignored because the connection is already in the disconnecting state.`),this._stopPromise;this._connectionState="Disconnecting",this._stopPromise=new Promise(t=>{this._stopPromiseResolver=t}),await this._stopInternal(e),await this._stopPromise}async _stopInternal(e){this._stopError=e;try{await this._startInternalPromise}catch{}if(this.transport){try{await this.transport.stop()}catch(t){this._logger.log(g.Error,`HttpConnection.transport.stop() threw error '${t}'.`),this._stopConnection()}this.transport=void 0}else this._logger.log(g.Debug,"HttpConnection.transport is undefined in HttpConnection.stop() because start() failed.")}async _startInternal(e){let t=this.baseUrl;this._accessTokenFactory=this._options.accessTokenFactory,this._httpClient._accessTokenFactory=this._accessTokenFactory;try{if(this._options.skipNegotiation)if(this._options.transport===z.WebSockets)this.transport=this._constructTransport(z.WebSockets),await this._startTransport(t,e);else throw new Error("Negotiation can only be skipped when using the WebSocket transport directly.");else{let r=null,o=0;do{if(r=await this._getNegotiationResponse(t),this._connectionState==="Disconnecting"||this._connectionState==="Disconnected")throw new te("The connection was stopped during negotiation.");if(r.error)throw new Error(r.error);if(r.ProtocolVersion)throw new Error("Detected a connection attempt to an ASP.NET SignalR Server. This client only supports connecting to an ASP.NET Core SignalR Server. See https://aka.ms/signalr-core-differences for details.");if(r.url&&(t=r.url),r.accessToken){const i=r.accessToken;this._accessTokenFactory=()=>i,this._httpClient._accessToken=i,this._httpClient._accessTokenFactory=void 0}o++}while(r.url&&o<Bt);if(o===Bt&&r.url)throw new Error("Negotiate redirection limit exceeded.");await this._createTransport(t,this._options.transport,r,e)}this.transport instanceof qt&&(this.features.inherentKeepAlive=!0),this._connectionState==="Connecting"&&(this._logger.log(g.Debug,"The HttpConnection connected successfully."),this._connectionState="Connected")}catch(r){return this._logger.log(g.Error,"Failed to start the connection: "+r),this._connectionState="Disconnected",this.transport=void 0,this._stopPromiseResolver(),Promise.reject(r)}}async _getNegotiationResponse(e){const t={},[r,o]=we();t[r]=o;const i=this._resolveNegotiateUrl(e);this._logger.log(g.Debug,`Sending negotiation request: ${i}.`);try{const a=await this._httpClient.post(i,{content:"",headers:{...t,...this._options.headers},timeout:this._options.timeout,withCredentials:this._options.withCredentials});if(a.statusCode!==200)return Promise.reject(new Error(`Unexpected status code returned from negotiate '${a.statusCode}'`));const c=JSON.parse(a.content);return(!c.negotiateVersion||c.negotiateVersion<1)&&(c.connectionToken=c.connectionId),c.useStatefulReconnect&&this._options._useStatefulReconnect!==!0?Promise.reject(new Ft("Client didn't negotiate Stateful Reconnect but the server did.")):c}catch(a){let c="Failed to complete negotiation with the server: "+a;return a instanceof ge&&a.statusCode===404&&(c=c+" Either this is not a SignalR endpoint or there is a proxy blocking the connection."),this._logger.log(g.Error,c),Promise.reject(new Ft(c))}}_createConnectUrl(e,t){return t?e+(e.indexOf("?")===-1?"?":"&")+`id=${t}`:e}async _createTransport(e,t,r,o){let i=this._createConnectUrl(e,r.connectionToken);if(this._isITransport(t)){this._logger.log(g.Debug,"Connection was provided an instance of ITransport, using that directly."),this.transport=t,await this._startTransport(i,o),this.connectionId=r.connectionId;return}const a=[],c=r.availableTransports||[];let l=r;for(const d of c){const u=this._resolveTransportOrError(d,t,o,l?.useStatefulReconnect===!0);if(u instanceof Error)a.push(`${d.transport} failed:`),a.push(u);else if(this._isITransport(u)){if(this.transport=u,!l){try{l=await this._getNegotiationResponse(e)}catch(b){return Promise.reject(b)}i=this._createConnectUrl(e,l.connectionToken)}try{await this._startTransport(i,o),this.connectionId=l.connectionId;return}catch(b){if(this._logger.log(g.Error,`Failed to start the transport '${d.transport}': ${b}`),l=void 0,a.push(new In(`${d.transport} failed: ${b}`,z[d.transport])),this._connectionState!=="Connecting"){const N="Failed to select transport before stop() was called.";return this._logger.log(g.Debug,N),Promise.reject(new te(N))}}}}return a.length>0?Promise.reject(new An(`Unable to connect to the server with any of the available transports. ${a.join(" ")}`,a)):Promise.reject(new Error("None of the transports supported by the client are supported by the server."))}_constructTransport(e){switch(e){case z.WebSockets:if(!this._options.WebSocket)throw new Error("'WebSocket' is not supported in your environment.");return new ro(this._httpClient,this._accessTokenFactory,this._logger,this._options.logMessageContent,this._options.WebSocket,this._options.headers||{});case z.ServerSentEvents:if(!this._options.EventSource)throw new Error("'EventSource' is not supported in your environment.");return new so(this._httpClient,this._httpClient._accessToken,this._logger,this._options);case z.LongPolling:return new qt(this._httpClient,this._logger,this._options);default:throw new Error(`Unknown transport: ${e}.`)}}_startTransport(e,t){return this.transport.onreceive=this.onreceive,this.features.reconnect?this.transport.onclose=async r=>{let o=!1;if(this.features.reconnect)try{this.features.disconnected(),await this.transport.connect(e,t),await this.features.resend()}catch{o=!0}else{this._stopConnection(r);return}o&&this._stopConnection(r)}:this.transport.onclose=r=>this._stopConnection(r),this.transport.connect(e,t)}_resolveTransportOrError(e,t,r,o){const i=z[e.transport];if(i==null)return this._logger.log(g.Debug,`Skipping transport '${e.transport}' because it is not supported by this client.`),new Error(`Skipping transport '${e.transport}' because it is not supported by this client.`);if(oo(t,i))if(e.transferFormats.map(c=>J[c]).indexOf(r)>=0){if(i===z.WebSockets&&!this._options.WebSocket||i===z.ServerSentEvents&&!this._options.EventSource)return this._logger.log(g.Debug,`Skipping transport '${z[i]}' because it is not supported in your environment.'`),new Tn(`'${z[i]}' is not supported in your environment.`,i);this._logger.log(g.Debug,`Selecting transport '${z[i]}'.`);try{return this.features.reconnect=i===z.WebSockets?o:void 0,this._constructTransport(i)}catch(c){return c}}else return this._logger.log(g.Debug,`Skipping transport '${z[i]}' because it does not support the requested transfer format '${J[r]}'.`),new Error(`'${z[i]}' does not support ${J[r]}.`);else return this._logger.log(g.Debug,`Skipping transport '${z[i]}' because it was disabled by the client.`),new Pn(`'${z[i]}' is disabled by the client.`,i)}_isITransport(e){return e&&typeof e=="object"&&"connect"in e}_stopConnection(e){if(this._logger.log(g.Debug,`HttpConnection.stopConnection(${e}) called while in state ${this._connectionState}.`),this.transport=void 0,e=this._stopError||e,this._stopError=void 0,this._connectionState==="Disconnected"){this._logger.log(g.Debug,`Call to HttpConnection.stopConnection(${e}) was ignored because the connection is already in the disconnected state.`);return}if(this._connectionState==="Connecting")throw this._logger.log(g.Warning,`Call to HttpConnection.stopConnection(${e}) was ignored because the connection is still in the connecting state.`),new Error(`HttpConnection.stopConnection(${e}) was called while the connection is still in the connecting state.`);if(this._connectionState==="Disconnecting"&&this._stopPromiseResolver(),e?this._logger.log(g.Error,`Connection disconnected with error '${e}'.`):this._logger.log(g.Information,"Connection disconnected."),this._sendQueue&&(this._sendQueue.stop().catch(t=>{this._logger.log(g.Error,`TransportSendQueue.stop() threw error '${t}'.`)}),this._sendQueue=void 0),this.connectionId=void 0,this._connectionState="Disconnected",this._connectionStarted){this._connectionStarted=!1;try{this.onclose&&this.onclose(e)}catch(t){this._logger.log(g.Error,`HttpConnection.onclose(${e}) threw error '${t}'.`)}}}_resolveUrl(e){if(e.lastIndexOf("https://",0)===0||e.lastIndexOf("http://",0)===0)return e;if(!L.isBrowser)throw new Error(`Cannot resolve '${e}'.`);const t=window.document.createElement("a");return t.href=e,this._logger.log(g.Information,`Normalizing '${e}' to '${t.href}'.`),t.href}_resolveNegotiateUrl(e){const t=new URL(e);t.pathname.endsWith("/")?t.pathname+="negotiate":t.pathname+="/negotiate";const r=new URLSearchParams(t.searchParams);return r.has("negotiateVersion")||r.append("negotiateVersion",this._negotiateVersion.toString()),r.has("useStatefulReconnect")?r.get("useStatefulReconnect")==="true"&&(this._options._useStatefulReconnect=!0):this._options._useStatefulReconnect===!0&&r.append("useStatefulReconnect","true"),t.search=r.toString(),t.toString()}}function oo(s,e){return!s||(e&s)!==0}class xt{constructor(e){this._transport=e,this._buffer=[],this._executing=!0,this._sendBufferedData=new De,this._transportResult=new De,this._sendLoopPromise=this._sendLoop()}send(e){return this._bufferData(e),this._transportResult||(this._transportResult=new De),this._transportResult.promise}stop(){return this._executing=!1,this._sendBufferedData.resolve(),this._sendLoopPromise}_bufferData(e){if(this._buffer.length&&typeof this._buffer[0]!=typeof e)throw new Error(`Expected data to be of type ${typeof this._buffer} but was of type ${typeof e}`);this._buffer.push(e),this._sendBufferedData.resolve()}async _sendLoop(){for(;;){if(await this._sendBufferedData.promise,!this._executing){this._transportResult&&this._transportResult.reject("Connection stopped.");break}this._sendBufferedData=new De;const e=this._transportResult;this._transportResult=void 0;const t=typeof this._buffer[0]=="string"?this._buffer.join(""):xt._concatBuffers(this._buffer);this._buffer.length=0;try{await this._transport.send(t),e.resolve()}catch(r){e.reject(r)}}}static _concatBuffers(e){const t=e.map(i=>i.byteLength).reduce((i,a)=>i+a),r=new Uint8Array(t);let o=0;for(const i of e)r.set(new Uint8Array(i),o),o+=i.byteLength;return r.buffer}}class De{constructor(){this.promise=new Promise((e,t)=>[this._resolver,this._rejecter]=[e,t])}resolve(){this._resolver()}reject(e){this._rejecter(e)}}const io="json";class ao{constructor(){this.name=io,this.version=2,this.transferFormat=J.Text}parseMessages(e,t){if(typeof e!="string")throw new Error("Invalid input for JSON hub protocol. Expected a string.");if(!e)return[];t===null&&(t=Re.instance);const r=Q.parse(e),o=[];for(const i of r){const a=JSON.parse(i);if(typeof a.type!="number")throw new Error("Invalid payload.");switch(a.type){case A.Invocation:this._isInvocationMessage(a);break;case A.StreamItem:this._isStreamItemMessage(a);break;case A.Completion:this._isCompletionMessage(a);break;case A.Ping:break;case A.Close:break;case A.Ack:this._isAckMessage(a);break;case A.Sequence:this._isSequenceMessage(a);break;default:t.log(g.Information,"Unknown message type '"+a.type+"' ignored.");continue}o.push(a)}return o}writeMessage(e){return Q.write(JSON.stringify(e))}_isInvocationMessage(e){this._assertNotEmptyString(e.target,"Invalid payload for Invocation message."),e.invocationId!==void 0&&this._assertNotEmptyString(e.invocationId,"Invalid payload for Invocation message.")}_isStreamItemMessage(e){if(this._assertNotEmptyString(e.invocationId,"Invalid payload for StreamItem message."),e.item===void 0)throw new Error("Invalid payload for StreamItem message.")}_isCompletionMessage(e){if(e.result&&e.error)throw new Error("Invalid payload for Completion message.");!e.result&&e.error&&this._assertNotEmptyString(e.error,"Invalid payload for Completion message."),this._assertNotEmptyString(e.invocationId,"Invalid payload for Completion message.")}_isAckMessage(e){if(typeof e.sequenceId!="number")throw new Error("Invalid SequenceId for Ack message.")}_isSequenceMessage(e){if(typeof e.sequenceId!="number")throw new Error("Invalid SequenceId for Sequence message.")}_assertNotEmptyString(e,t){if(typeof e!="string"||e==="")throw new Error(t)}}const co={trace:g.Trace,debug:g.Debug,info:g.Information,information:g.Information,warn:g.Warning,warning:g.Warning,error:g.Error,critical:g.Critical,none:g.None};function lo(s){const e=co[s.toLowerCase()];if(typeof e<"u")return e;throw new Error(`Unknown log level: ${s}`)}class js{configureLogging(e){if(B.isRequired(e,"logging"),uo(e))this.logger=e;else if(typeof e=="string"){const t=lo(e);this.logger=new Be(t)}else this.logger=new Be(e);return this}withUrl(e,t){return B.isRequired(e,"url"),B.isNotEmpty(e,"url"),this.url=e,typeof t=="object"?this.httpConnectionOptions={...this.httpConnectionOptions,...t}:this.httpConnectionOptions={...this.httpConnectionOptions,transport:t},this}withHubProtocol(e){return B.isRequired(e,"protocol"),this.protocol=e,this}withAutomaticReconnect(e){if(this.reconnectPolicy)throw new Error("A reconnectPolicy has already been set.");return e?Array.isArray(e)?this.reconnectPolicy=new Lt(e):this.reconnectPolicy=e:this.reconnectPolicy=new Lt,this}withServerTimeout(e){return B.isRequired(e,"milliseconds"),this._serverTimeoutInMilliseconds=e,this}withKeepAliveInterval(e){return B.isRequired(e,"milliseconds"),this._keepAliveIntervalInMilliseconds=e,this}withStatefulReconnect(e){return this.httpConnectionOptions===void 0&&(this.httpConnectionOptions={}),this.httpConnectionOptions._useStatefulReconnect=!0,this._statefulReconnectBufferSize=e?.bufferSize,this}build(){const e=this.httpConnectionOptions||{};if(e.logger===void 0&&(e.logger=this.logger),!this.url)throw new Error("The 'HubConnectionBuilder.withUrl' method must be called before building the connection.");const t=new no(this.url,e);return pt.create(t,this.logger||Re.instance,this.protocol||new ao,this.reconnectPolicy,this._serverTimeoutInMilliseconds,this._keepAliveIntervalInMilliseconds,this._statefulReconnectBufferSize)}}function uo(s){return s.log!==void 0}const ye="http://localhost:5082/api",Ht=()=>{const{courseId:s}=Ts(),[e]=Ps(),t=e.get("type")||"course",r=e.get("chatId"),[o,i]=y.useState(""),[a,c]=y.useState(t),l=y.useRef(null),[d,u]=y.useState([]),[b,N]=y.useState([]),[k,p]=y.useState(null),[S,_]=y.useState([]),[R,I]=y.useState([]),[x,j]=y.useState(null),[C,F]=y.useState(null),[M,T]=y.useState({}),q=JSON.parse(sessionStorage.getItem("currentUser")||"{}"),U=q.id;y.useEffect(()=>{t==="private"?(c("private"),le()):(c("course"),X())},[t,s]),y.useEffect(()=>{if(r&&R.length>0){const f=parseInt(r),v=R.find(m=>m.id===f||m.chatId===f);if(v){j(v);const m=v.chatId||v.id;(!M[m.toString()]||M[m.toString()].length===0)&&ie(m)}}},[r,R]),y.useEffect(()=>{const f=new js().withUrl("http://localhost:5082/chatHub").withAutomaticReconnect().configureLogging(g.Information).build();return f.start().then(()=>{F(f)}).catch(v=>{console.error("SignalR Connection Error:",v)}),()=>{f.state===D.Connected&&f.stop()}},[]),y.useEffect(()=>{if(!C||C.state!==D.Connected)return;const f=v=>{if(k&&v.courseId.toString()===k.id.toString()){const P={id:v.id,text:v.content,sender:v.sender,isCurrentUser:v.senderId===U,timestamp:new Date(v.timestamp).toLocaleString("en-US",{month:"short",day:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",hour12:!0}).replace(","," -"),avatar:v.avatar};u(O=>[...O,P])}};return C.off("ReceiveCourseMessage"),C.on("ReceiveCourseMessage",f),()=>{C.off("ReceiveCourseMessage",f)}},[C,k,U]),y.useEffect(()=>{if(!C||C.state!==D.Connected)return;const f=v=>{const m={id:v.id,content:v.content,senderName:v.sender,isFromMe:v.senderId===U,sentAt:v.timestamp,senderAvatar:v.avatar};T(P=>{const O=v.chatId.toString(),K=[...P[O]||[],m];return{...P,[O]:K}}),I(P=>P.map(O=>(O.chatId||O.id).toString()===v.chatId.toString()?{...O,lastMessage:{content:v.content,sentAt:v.timestamp,isFromMe:v.senderId===U}}:O))};return C.off("ReceivePrivateMessage"),C.on("ReceivePrivateMessage",f),()=>{C.off("ReceivePrivateMessage",f)}},[C,U]),y.useEffect(()=>{if(x){const f=(x.chatId||x.id).toString(),v=M[f]||[];_(v)}},[x,M]),y.useEffect(()=>{if(C&&C.state===D.Connected&&k)return C.invoke("JoinCourseGroup",k.id.toString()).catch(()=>{}),()=>{C.state===D.Connected&&C.invoke("LeaveCourseGroup",k.id.toString()).catch(()=>{})}},[C,k]),y.useEffect(()=>{if(C&&C.state===D.Connected&&x){const f=x.chatId||x.id;return C.invoke("JoinPrivateChat",f.toString()).catch(()=>{}),()=>{C.state===D.Connected&&C.invoke("LeavePrivateChat",f.toString()).catch(()=>{})}}},[C,x]),y.useEffect(()=>{l.current?.scrollIntoView({behavior:"smooth"})},[d,S]),y.useEffect(()=>{x&&setTimeout(()=>{l.current?.scrollIntoView({behavior:"smooth"})},100)},[x]);const X=async()=>{try{const v=await(await fetch(`${ye}/courses/user/${U}`)).json();if(N(v),s){const m=v.find(P=>P.id===parseInt(s));m&&(p(m),Z(m.id))}}catch(f){console.error("Error fetching courses:",f)}},Z=async f=>{try{const v=await fetch(`${ye}/courses/${f}/messages`);if(!v.ok)throw new Error(`Failed to load messages: ${v.status}`);const P=(await v.json()).map(O=>({id:O.id,text:O.content,timestamp:O.formattedTimestamp||new Date(O.timestamp).toLocaleString("en-US",{month:"short",day:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",hour12:!0}).replace(","," -"),sender:O.sender?.username||"Unknown",isCurrentUser:O.senderId===U,avatar:O.sender?.profilePictureUrl||"/default-avatar.png"}));u(P)}catch(v){console.error("Failed to load messages:",v)}},oe=f=>{p(f),Z(f.id)},xe=async f=>{if(f.preventDefault(),!o.trim()||!k)return;const v={content:o,senderId:U};try{const m=await fetch(`${ye}/courses/${k.id}/messages`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(v)});if(!m.ok)throw new Error(`Failed to send message: ${m.status}`);i("")}catch(m){console.error("Failed to send message:",m),alert("Failed to send message. Please try again.")}},le=async()=>{try{const v=(await E.get(`${ye}/Chat/user/${U}`)).data.map(m=>({...m,chatId:m.chatId||m.id}));I(v)}catch(f){console.error("Error fetching private chats:",f)}},ie=async f=>{try{const m=(await E.get(`${ye}/Chat/${f}/messages?userId=${U}`)).data;T(P=>({...P,[f.toString()]:m}))}catch(v){console.error("Error fetching private messages:",v)}},de=async f=>{if(f.preventDefault(),!(!o.trim()||!x))try{const v=x.chatId||x.id;await E.post(`${ye}/Chat/${v}/messages`,{senderId:U,content:o}),i("")}catch(v){console.error("Error sending private message:",v),alert("Failed to send message. Please try again.")}},ae=f=>{c(f),f==="course"?X():le()},w=f=>{try{const v=new Date(f);return isNaN(v.getTime())?"Invalid date":v.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}catch{return"Invalid date"}};return n.jsxs("div",{className:"h-[calc(100vh-10rem)] flex flex-col md:flex-row",children:[n.jsxs("div",{className:"w-full md:w-64 bg-white dark:bg-gray-800 border-r border-gray-200 dark:border-gray-700 overflow-y-auto",children:[n.jsxs("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:[n.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[n.jsx("button",{onClick:()=>window.history.back(),className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",children:n.jsx(dt,{size:20})}),n.jsx("h2",{className:"font-semibold text-lg",children:"Chat"})]}),n.jsxs("div",{className:"flex bg-gray-100 dark:bg-gray-700 rounded-lg p-1",children:[n.jsxs("button",{onClick:()=>ae("course"),className:`flex-1 px-3 py-2 rounded-md text-sm font-medium transition-colors ${a==="course"?"bg-white dark:bg-gray-600 text-gray-900 dark:text-gray-100 shadow-sm":"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200"}`,children:[n.jsx($e,{size:14,className:"inline mr-1"}),"Courses"]}),n.jsxs("button",{onClick:()=>ae("private"),className:`flex-1 px-3 py-2 rounded-md text-sm font-medium transition-colors ${a==="private"?"bg-white dark:bg-gray-600 text-gray-900 dark:text-gray-100 shadow-sm":"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200"}`,children:[n.jsx(ce,{size:14,className:"inline mr-1"}),"Private"]})]})]}),n.jsx("div",{className:"p-2",children:a==="course"?b.map(f=>n.jsx("button",{onClick:()=>oe(f),className:`w-full text-left p-3 rounded-lg mb-1 ${k?.id===f.id?"bg-blue-100 dark:bg-blue-900/40 text-blue-800 dark:text-blue-300":"hover:bg-gray-100 dark:hover:bg-gray-700"}`,children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:"w-6 h-6 bg-blue-500 rounded-md flex items-center justify-center flex-shrink-0",children:n.jsx($e,{size:12,className:"text-white"})}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("p",{className:"font-medium truncate",children:f.name}),n.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 truncate",children:f.code})]})]})},f.id)):n.jsxs(n.Fragment,{children:[R.map(f=>n.jsx("button",{onClick:()=>{j(f);const v=f.chatId||f.id;(!M[v.toString()]||M[v.toString()].length===0)&&ie(v)},className:`w-full text-left p-3 rounded-lg mb-1 ${x?.id===f.id?"bg-blue-100 dark:bg-blue-900/40 text-blue-800 dark:text-blue-300":"hover:bg-gray-100 dark:hover:bg-gray-700"}`,children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("img",{src:f.otherUser.avatar||"/default-avatar.png",alt:f.otherUser.name,className:"w-6 h-6 rounded-full object-cover flex-shrink-0"}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("p",{className:"font-medium truncate pr-2",children:f.otherUser.name}),f.lastMessage&&n.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 truncate",children:[f.lastMessage.isFromMe?"You: ":"",f.lastMessage.content]})]})]})},f.id)),R.length===0&&n.jsxs("div",{className:"text-center text-gray-500 dark:text-gray-400 py-6",children:[n.jsx(ce,{className:"mx-auto h-8 w-8 mb-2"}),n.jsx("p",{className:"text-sm",children:"No private chats yet"}),n.jsx("p",{className:"text-xs",children:"Start a chat from connections"})]})]})})]}),n.jsx("div",{className:"flex-1 flex flex-col",children:a==="course"&&k?n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"p-4 bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-8 h-8 bg-blue-500 rounded-md flex items-center justify-center",children:n.jsx($e,{size:16,className:"text-white"})}),n.jsxs("div",{children:[n.jsx("h2",{className:"font-semibold text-lg",children:k.name}),n.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:k.code})]})]}),n.jsxs(W,{to:"/courses",className:"flex items-center text-sm text-blue-600 dark:text-blue-400 hover:underline",children:[n.jsx(Vt,{size:16,className:"mr-1"}),"View Course"]})]}),n.jsxs("div",{className:"flex-1 p-4 overflow-y-auto bg-gray-50 dark:bg-gray-900",children:[d.map(f=>n.jsxs("div",{className:`flex mb-8 ${f.isCurrentUser?"justify-end":"justify-start"} items-start`,children:[!f.isCurrentUser&&n.jsx("img",{src:f.avatar,alt:f.sender,className:"h-8 w-8 rounded-full mr-2 mt-10"}),n.jsxs("div",{className:`max-w-[70%] ${f.isCurrentUser?"order-1":"order-2"}`,children:[!f.isCurrentUser&&n.jsx("p",{className:"text-s mb-1",children:f.sender}),f.isCurrentUser&&n.jsx("p",{className:"text-s mb-1 text-right",children:f.sender}),n.jsx("div",{className:`p-3 rounded-lg ${f.isCurrentUser?"bg-blue-600 text-white rounded-br-none":"bg-white dark:bg-gray-800 rounded-bl-none"}`,children:n.jsx("p",{children:f.text})}),n.jsx("p",{className:`text-xs text-gray-500 dark:text-gray-400 mt-1 ${f.isCurrentUser?"text-right":"text-left"}`,children:f.timestamp})]}),f.isCurrentUser&&n.jsx("img",{src:f.avatar,alt:f.sender,className:"h-8 w-8 rounded-full ml-2 mt-9"})]},f.id)),n.jsx("div",{ref:l})]}),n.jsx("form",{onSubmit:xe,className:"p-4 bg-white dark:bg-gray-800 border-t border-gray-200 dark:border-gray-700",children:n.jsxs("div",{className:"flex",children:[n.jsx("input",{type:"text",value:o,onChange:f=>i(f.target.value),placeholder:`Message ${k.name}...`,className:"flex-1 px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-l-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700"}),n.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-r-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",children:n.jsx(_t,{size:18})})]})})]}):a==="private"&&x?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"p-4 bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700",children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("img",{src:x.otherUser.avatar||"/default-avatar.png",alt:x.otherUser.name,className:"w-8 h-8 rounded-full object-cover"}),n.jsxs("div",{children:[n.jsx("h2",{className:"font-semibold text-lg",children:x.otherUser.name}),n.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Private Chat"})]})]})}),n.jsxs("div",{className:"flex-1 p-4 overflow-y-auto bg-gray-50 dark:bg-gray-900",children:[S.map(f=>n.jsxs("div",{className:`flex mb-8 ${f.isFromMe?"justify-end":"justify-start"} items-start`,children:[!f.isFromMe&&n.jsx("img",{src:f.senderAvatar||"/default-avatar.png",alt:f.senderName,className:"h-8 w-8 rounded-full mr-2 mt-10"}),n.jsxs("div",{className:`max-w-[70%] ${f.isFromMe?"order-1":"order-2"}`,children:[!f.isFromMe&&n.jsx("p",{className:"text-s mb-1",children:f.senderName}),f.isFromMe&&n.jsx("p",{className:"text-s mb-1 text-right",children:"You"}),n.jsx("div",{className:`p-3 rounded-lg ${f.isFromMe?"bg-blue-600 text-white rounded-br-none":"bg-white dark:bg-gray-800 rounded-bl-none"}`,children:n.jsx("p",{children:f.content})}),n.jsx("p",{className:`text-xs text-gray-500 dark:text-gray-400 mt-1 ${f.isFromMe?"text-right":"text-left"}`,children:w(f.sentAt)})]}),f.isFromMe&&n.jsx("img",{src:q.profilePictureUrl||"/default-avatar.png",alt:"You",className:"h-8 w-8 rounded-full ml-2 mt-9"})]},f.id)),n.jsx("div",{ref:l})]}),n.jsx("form",{onSubmit:de,className:"p-4 bg-white dark:bg-gray-800 border-t border-gray-200 dark:border-gray-700",children:n.jsxs("div",{className:"flex",children:[n.jsx("input",{type:"text",value:o,onChange:f=>i(f.target.value),placeholder:`Message ${x.otherUser.name}...`,className:"flex-1 px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-l-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700"}),n.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-r-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",children:n.jsx(_t,{size:18})})]})})]}):n.jsx("div",{className:"flex-1 flex items-center justify-center bg-gray-50 dark:bg-gray-900",children:n.jsxs("div",{className:"text-center p-6",children:[n.jsx("div",{className:"bg-blue-100 dark:bg-blue-900/30 p-6 rounded-full inline-flex items-center justify-center mb-4",children:a==="course"?n.jsx($e,{size:32,className:"text-blue-600 dark:text-blue-400"}):n.jsx(ce,{size:32,className:"text-blue-600 dark:text-blue-400"})}),n.jsx("h2",{className:"text-xl font-semibold mb-2",children:a==="course"?"Select a Course Chat":"Select a Private Chat"}),n.jsx("p",{className:"text-gray-600 dark:text-gray-400 max-w-sm",children:a==="course"?"Choose a course from the sidebar to join the conversation with your classmates.":"Choose a private chat from the sidebar to start messaging with your connections."})]})})})]})},ho=({onLogin:s})=>{const[e,t]=y.useState(""),[r,o]=y.useState(""),[i,a]=y.useState(!1),{toasts:c,showSuccess:l,showError:d,hideToast:u}=Ae(),b=async N=>{N.preventDefault(),a(!0);try{const k=await E.post("http://localhost:5082/api/users/login",{email:e,password:r});if(k.status===200){const p=k.data;sessionStorage.setItem("currentUser",JSON.stringify(p)),l(`Welcome back, ${p.name||p.email}!`),setTimeout(()=>{s()},1500)}}catch(k){k.response?.status===401?d("Invalid email or password. Please check your credentials and try again."):k.response?.status===404?d("Account not found. Please check your email address."):k.response?.status===400?d("Please enter a valid email address and password."):k.code==="ECONNABORTED"||k.code==="NETWORK_ERROR"?d("Connection timeout. Please check your internet connection and try again."):d("Login failed. Please try again or contact support if the problem persists.")}finally{a(!1)}};return n.jsxs("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900 px-4 py-12 transition-colors duration-300",children:[n.jsx("div",{className:"fixed top-0 right-0 z-50 space-y-2 p-4",children:c.map(N=>n.jsx(Ge,{message:N.message,type:N.type,onClose:()=>u(N.id)},N.id))}),n.jsx("div",{className:"absolute top-4 right-4",children:n.jsx(ut,{})}),n.jsxs(W,{to:"/",className:"absolute top-4 left-4 flex items-center p-2 text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white transition-colors",children:[n.jsx(dt,{size:20,className:"mr-1"}),n.jsx("span",{className:"text-sm",children:"Back to Home"})]}),n.jsxs("div",{className:"max-w-md w-full space-y-8 bg-white dark:bg-gray-800 p-8 rounded-xl shadow-lg transition-colors",children:[n.jsxs("div",{className:"text-center",children:[n.jsx("h1",{className:"text-3xl font-bold text-blue-600 dark:text-blue-400",children:"ClassConnect"}),n.jsx("p",{className:"mt-2 text-gray-600 dark:text-gray-300",children:"Connect with classmates in your courses"})]}),n.jsxs("form",{className:"mt-8 space-y-6",onSubmit:b,children:[n.jsxs("div",{children:[n.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Email address"}),n.jsx("input",{id:"email",name:"email",type:"email",required:!0,value:e,onChange:N=>t(N.target.value),disabled:i,className:"mt-1 block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 dark:placeholder-gray-500 dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-blue-500 focus:border-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",placeholder:"you@example.com"})]}),n.jsxs("div",{children:[n.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Password"}),n.jsx("input",{id:"password",name:"password",type:"password",required:!0,value:r,onChange:N=>o(N.target.value),disabled:i,className:"mt-1 block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 dark:placeholder-gray-500 dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-blue-500 focus:border-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"})]}),n.jsx("div",{children:n.jsx("button",{type:"submit",disabled:i,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:i?n.jsxs("div",{className:"flex items-center",children:[n.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[n.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),n.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Signing in..."]}):"Sign in"})})]}),n.jsx("div",{className:"text-center text-sm",children:n.jsxs("p",{className:"text-gray-600 dark:text-gray-400",children:["Don't have an account?"," ",n.jsx(W,{to:"/SignUp",className:"text-blue-600 dark:text-blue-400 hover:underline",children:"Sign up"})]})})]})]})},go=()=>{const{theme:s,toggleTheme:e}=Qt(),t=[{icon:n.jsx(Ne,{size:24,className:"text-blue-600"}),title:"Course Connections",description:"Find and connect with classmates in all your courses"},{icon:n.jsx(ce,{size:24,className:"text-blue-600"}),title:"Group Discussions",description:"Join course-specific chat rooms to discuss assignments and lectures"},{icon:n.jsx(He,{size:24,className:"text-blue-600"}),title:"Study Partners",description:"Find study partners with similar interests and goals"}],r=[{quote:"ClassConnect helped me find study partners in my toughest classes. My grades improved dramatically!",name:"Sarah J.",role:"Computer Science Major",avatar:"https://images.unsplash.com/photo-1494790108377-be9c29b29330?ixlib=rb-1.2.1&auto=format&fit=facearea&facepad=2.25&w=256&h=256&q=80"},{quote:"The course-specific chat rooms made it easy to get quick help on assignments when I was stuck.",name:"Michael T.",role:"Engineering Student",avatar:"https://images.unsplash.com/photo-1500648767791-00dcc994a43e?ixlib=rb-1.2.1&auto=format&fit=facearea&facepad=2.25&w=256&h=256&q=80"}];return n.jsxs("div",{className:"min-h-screen flex flex-col bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100 transition-colors duration-200",children:[n.jsxs("header",{className:"py-4 px-6 md:px-10 flex items-center justify-between bg-white dark:bg-gray-800 shadow-sm",children:[n.jsx("div",{className:"flex items-center",children:n.jsx("h1",{className:"text-xl md:text-2xl font-bold text-blue-600 dark:text-blue-400",children:"ClassConnect"})}),n.jsxs("div",{className:"flex items-center space-x-4",children:[n.jsx("button",{onClick:e,className:"p-2 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors","aria-label":s==="dark"?"Switch to light mode":"Switch to dark mode",children:s==="dark"?n.jsx(Wt,{size:20}):n.jsx(Jt,{size:20})}),n.jsx(W,{to:"/login",className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md text-sm font-medium hover:bg-gray-50 dark:hover:bg-gray-700",children:"Sign In"}),n.jsx(W,{to:"/signup",className:"px-4 py-2 bg-blue-600 text-white rounded-md text-sm font-medium hover:bg-blue-700",children:"Sign Up"})]})]}),n.jsxs("section",{className:"flex-1 flex flex-col lg:flex-row items-center px-6 md:px-10 py-12 md:py-20",children:[n.jsxs("div",{className:"w-full lg:w-1/2 mb-10 lg:mb-0 lg:pr-10",children:[n.jsx("h2",{className:"text-3xl md:text-4xl font-bold mb-4 leading-tight",children:"Connect with classmates and succeed together"}),n.jsx("p",{className:"text-lg text-gray-600 dark:text-gray-300 mb-8",children:"ClassConnect helps you find and collaborate with students in your courses. Join discussions, form study groups, and build your academic network."}),n.jsxs("div",{className:"flex flex-col sm:flex-row space-y-4 sm:space-y-0 sm:space-x-4",children:[n.jsx(W,{to:"/signup",className:"px-6 py-3 bg-blue-600 text-white rounded-md text-center font-medium text-lg hover:bg-blue-700 transition-colors",children:"Get Started"}),n.jsx(W,{to:"/login",className:"px-6 py-3 border border-gray-300 dark:border-gray-600 rounded-md text-center font-medium text-lg hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors",children:"Sign In"})]})]}),n.jsx("div",{className:"w-full lg:w-1/2",children:n.jsx("img",{src:"https://images.unsplash.com/photo-1522202176988-66273c2fd55f?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1171&q=80",alt:"Students collaborating",className:"rounded-xl shadow-lg w-full"})})]}),n.jsx("section",{className:"py-12 md:py-20 px-6 md:px-10 bg-gray-50 dark:bg-gray-800",children:n.jsxs("div",{className:"max-w-6xl mx-auto",children:[n.jsx("h2",{className:"text-2xl md:text-3xl font-bold text-center mb-12",children:"How ClassConnect helps students"}),n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:t.map((o,i)=>n.jsxs("div",{className:"bg-white dark:bg-gray-700 p-6 rounded-xl shadow-sm",children:[n.jsx("div",{className:"bg-blue-100 dark:bg-blue-900/30 p-3 rounded-full inline-flex mb-4",children:o.icon}),n.jsx("h3",{className:"text-xl font-semibold mb-2",children:o.title}),n.jsx("p",{className:"text-gray-600 dark:text-gray-300",children:o.description})]},i))})]})}),n.jsx("section",{className:"py-12 md:py-20 px-6 md:px-10",children:n.jsxs("div",{className:"max-w-6xl mx-auto",children:[n.jsx("h2",{className:"text-2xl md:text-3xl font-bold text-center mb-12",children:"What students are saying"}),n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:r.map((o,i)=>n.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-xl shadow border border-gray-100 dark:border-gray-700",children:[n.jsxs("p",{className:"text-gray-600 dark:text-gray-300 mb-4 italic",children:['"',o.quote,'"']}),n.jsxs("div",{className:"flex items-center",children:[n.jsx("img",{src:o.avatar,alt:o.name,className:"h-12 w-12 rounded-full mr-4"}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium",children:o.name}),n.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:o.role})]})]})]},i))})]})}),n.jsx("section",{className:"py-12 md:py-20 px-6 md:px-10 bg-blue-600 text-white text-center",children:n.jsxs("div",{className:"max-w-3xl mx-auto",children:[n.jsx("h2",{className:"text-2xl md:text-3xl font-bold mb-4",children:"Ready to connect with your classmates?"}),n.jsx("p",{className:"text-lg mb-8 opacity-90",children:"Join thousands of students using ClassConnect to improve their academic experience"}),n.jsx(W,{to:"/signup",className:"px-8 py-3 bg-white text-blue-600 rounded-md font-medium text-lg hover:bg-gray-100 transition-colors inline-block",children:"Sign Up Now"})]})}),n.jsxs("footer",{className:"py-8 px-6 md:px-10 bg-gray-100 dark:bg-gray-800 text-center",children:[n.jsxs("p",{className:"text-gray-600 dark:text-gray-300",children:["© ",new Date().getFullYear()," ClassConnect. All rights reserved."]}),n.jsxs("div",{className:"flex justify-center mt-4 space-x-4",children:[n.jsx("a",{className:"text-gray-500 hover:text-gray-700 dark:hover:text-gray-300",children:"Terms"}),n.jsx("a",{className:"text-gray-500 hover:text-gray-700 dark:hover:text-gray-300",children:"Privacy"}),n.jsx("a",{className:"text-gray-500 hover:text-gray-700 dark:hover:text-gray-300",children:"Help"})]})]})]})},fo=({onSignUp:s})=>{const[e,t]=y.useState({firstName:"",lastName:"",email:"",password:"",confirmPassword:"",bio:"",major:"",year:"Freshman"}),[r,o]=y.useState(!1),[i,a]=y.useState({}),c=p=>{const{name:S,value:_}=p.target;t({...e,[S]:_}),i[S]&&a({...i,[S]:""})},l=()=>o(!r),d=()=>{const p={};return e.firstName||(p.firstName="First name is required"),e.lastName||(p.lastName="Last name is required"),e.email?/\S+@\S+\.\S+/.test(e.email)||(p.email="Email is invalid"):p.email="Email is required",e.password?e.password.length<8&&(p.password="Password must be at least 8 characters"):p.password="Password is required",e.password!==e.confirmPassword&&(p.confirmPassword="Passwords do not match"),e.bio||(p.bio="Bio is required - tell us about yourself"),e.major||(p.major="Major is required"),p},u=["Hidden","Anonymous","Silent","Mysterious","Ghostly","Wandering"],b=["Falcon","Panda","Cactus","Knight","Shadow","Otter"];function N(){const p=u[Math.floor(Math.random()*u.length)],S=b[Math.floor(Math.random()*b.length)],_=Math.floor(Math.random()*1e3);return`${p}${S}${_}`}const k=async p=>{p.preventDefault();const S=d();if(Object.keys(S).length>0){a(S);return}const _=N(),R={name:`${e.firstName} ${e.lastName}`,email:e.email,bio:e.bio,password:e.password,username:_,year:e.year,major:e.major,profilePictureUrl:""};console.log("Sending user data:",R);try{const x=(await E.post("http://localhost:5082/api/users",R,{headers:{"Content-Type":"application/json"}})).data;sessionStorage.setItem("currentUser",JSON.stringify(x)),s()}catch(I){if(console.error("Full error:",I),I.response){const x=I.response.status,j=I.response.data?.message||I.response.data||"Unknown error";x===409?a({email:"Email is already registered"}):alert(x===415?"Server error: Content type not supported. Check backend configuration.":`Error creating account (${x}): ${j}`)}else alert("Network error: Unable to connect to server. Make sure your backend is running.")}};return n.jsxs("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900 px-4 py-12 transition-colors duration-200",children:[n.jsx("div",{className:"absolute top-4 right-4",children:n.jsx(ut,{})}),n.jsxs(W,{to:"/",className:"absolute top-4 left-4 flex items-center p-2 text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white transition-colors",children:[n.jsx(dt,{size:20,className:"mr-1"}),n.jsx("span",{className:"text-sm",children:"Back to Home"})]}),n.jsxs("div",{className:"max-w-3xl w-full space-y-8 bg-white dark:bg-gray-800 p-8 rounded-xl shadow-lg",children:[n.jsxs("div",{className:"text-center",children:[n.jsx("h1",{className:"text-3xl font-bold text-blue-600 dark:text-blue-400",children:"Create Your Account"}),n.jsx("p",{className:"mt-2 text-gray-600 dark:text-gray-300",children:"Join ClassConnect to connect with classmates and ace your courses"})]}),n.jsxs("form",{className:"mt-8 space-y-6",onSubmit:k,children:[n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:["firstName","lastName"].map(p=>n.jsxs("div",{children:[n.jsx("label",{htmlFor:p,className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:p==="firstName"?"First Name":"Last Name"}),n.jsx("input",{id:p,name:p,type:"text",required:!0,value:e[p],onChange:c,className:`block w-full px-3 py-2 border ${i[p]?"border-red-500":"border-gray-300 dark:border-gray-600"} rounded-md shadow-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500`}),i[p]&&n.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:i[p]})]},p))}),n.jsxs("div",{children:[n.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Email Address"}),n.jsx("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,value:e.email,onChange:c,className:`block w-full px-3 py-2 border ${i.email?"border-red-500":"border-gray-300 dark:border-gray-600"} rounded-md shadow-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500`}),i.email&&n.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:i.email})]}),n.jsxs("div",{children:[n.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Password"}),n.jsxs("div",{className:"relative",children:[n.jsx("input",{id:"password",name:"password",type:r?"text":"password",required:!0,value:e.password,onChange:c,className:`block w-full px-3 py-2 border ${i.password?"border-red-500":"border-gray-300 dark:border-gray-600"} rounded-md shadow-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500`}),n.jsx("button",{type:"button",onClick:l,className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:r?n.jsx(Ms,{size:20,className:"text-gray-500"}):n.jsx(Ls,{size:20,className:"text-gray-500"})})]}),i.password&&n.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:i.password})]}),n.jsxs("div",{children:[n.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Confirm Password"}),n.jsx("input",{id:"confirmPassword",name:"confirmPassword",type:"password",required:!0,value:e.confirmPassword,onChange:c,className:`block w-full px-3 py-2 border ${i.confirmPassword?"border-red-500":"border-gray-300 dark:border-gray-600"} rounded-md shadow-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-blue-500 focus:border-blue-500`}),i.confirmPassword&&n.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:i.confirmPassword})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[n.jsxs("div",{className:"md:col-span-2",children:[n.jsx("label",{htmlFor:"major",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Major"}),n.jsx("input",{id:"major",name:"major",type:"text",required:!0,value:e.major,onChange:c,className:`block w-full px-3 py-2 border ${i.major?"border-red-500":"border-gray-300 dark:border-gray-600"} rounded-md shadow-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-blue-500 focus:border-blue-500`}),i.major&&n.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:i.major})]}),n.jsxs("div",{children:[n.jsx("label",{htmlFor:"year",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Year"}),n.jsxs("select",{id:"year",name:"year",value:e.year,onChange:c,className:"block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-blue-500 focus:border-blue-500",children:[n.jsx("option",{children:"First Year"}),n.jsx("option",{children:"Second Year"}),n.jsx("option",{children:"Third Year"}),n.jsx("option",{children:"Fourth Year"}),n.jsx("option",{children:"PostGraduate"})]})]}),n.jsxs("div",{className:"md:col-span-3",children:[n.jsx("label",{htmlFor:"bio",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Bio - Tell us about yourself"}),n.jsx("input",{id:"bio",name:"bio",type:"text",required:!0,value:e.bio,onChange:c,className:`block w-full px-3 py-2 border ${i.bio?"border-red-500":"border-gray-300 dark:border-gray-600"} rounded-md shadow-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-blue-500 focus:border-blue-500`}),i.bio&&n.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:i.bio})]})]}),n.jsxs("div",{className:"flex items-start",children:[n.jsx("input",{id:"terms",name:"terms",type:"checkbox",required:!0,className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 dark:border-gray-600 dark:bg-gray-700 rounded"}),n.jsxs("label",{htmlFor:"terms",className:"ml-2 text-sm text-gray-700 dark:text-gray-300",children:["I agree to the"," ",n.jsx("a",{href:"#",className:"text-blue-600 dark:text-blue-400 hover:underline",children:"Terms of Service"})," ","and"," ",n.jsx("a",{href:"#",className:"text-blue-600 dark:text-blue-400 hover:underline",children:"Privacy Policy"})]})]}),n.jsx("div",{children:n.jsx("button",{type:"submit",className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Create Account"})})]}),n.jsx("div",{className:"text-center text-sm",children:n.jsxs("p",{className:"text-gray-600 dark:text-gray-400",children:["Already have an account?"," ",n.jsx(W,{to:"/login",className:"text-blue-600 dark:text-blue-400 hover:underline",children:"Sign in"})]})})]})]})},ne="http://localhost:5082/api",mo=()=>{const[s,e]=y.useState("connections"),[t,r]=y.useState(""),[o,i]=y.useState("All Courses"),[a,c]=y.useState([]),[l,d]=y.useState([]),[u,b]=y.useState([]),[N,k]=y.useState([]),[p,S]=y.useState(["All Courses"]),[_,R]=y.useState(new Set),I=y.useRef(null),j=JSON.parse(sessionStorage.getItem("currentUser")||"{}").id,{toasts:C,showSuccess:F,showError:M,hideToast:T}=Ae(),q=y.useCallback(async()=>{if(j)try{const P=(await E.get(`${ne}/courses/user/${j}`)).data.map(O=>O.name||O.Name);k(P),S(["All Courses",...P])}catch(m){console.error("Error fetching user courses:",m)}},[j]),U=y.useCallback(async()=>{if(j)try{console.log("🔄 Fetching connections...");const m=await E.get(`${ne}/Connection/accepted/${j}`);c(m.data||[]),console.log(`✅ Loaded ${m.data?.length||0} connections`)}catch(m){console.error("❌ Error fetching connections:",m),c([])}},[j]),X=y.useCallback(async()=>{if(j)try{console.log("🔄 Fetching requests for user:",j);const m=await E.get(`${ne}/Connection/pending/${j}`);console.log("📥 Received requests data:",m.data),d(m.data||[]),console.log(`✅ Loaded ${m.data?.length||0} pending requests`)}catch(m){console.error("❌ Error fetching requests:",m),d([])}},[j]),Z=y.useCallback(async()=>{if(j)try{console.log("🔄 Fetching suggestions...");const m=await E.get(`${ne}/Connection/suggestions/${j}`);b(m.data||[]),console.log(`✅ Loaded ${m.data?.length||0} suggestions`)}catch(m){console.error("❌ Error fetching suggestions:",m),b([])}},[j]),oe=y.useCallback(async()=>{if(j)try{console.log("🔄 Fetching outgoing requests...");const m=await E.get(`${ne}/Connection/outgoing/${j}`);R(new Set(m.data.map(P=>P.ReceiverId))),console.log(`✅ Loaded ${m.data?.length||0} outgoing requests`)}catch(m){console.error("❌ Error fetching outgoing requests:",m),R(new Set)}},[j]);y.useEffect(()=>{if(!j)return;let m=!1,P=null;return(async()=>{console.log("🔄 Fetching initial data...");try{await Promise.all([q(),U(),X(),Z(),oe()]),console.log("✅ Initial data loaded successfully")}catch(K){console.error("❌ Error loading initial data:",K)}const H=new js().withUrl("http://localhost:5082/connectionHub").withAutomaticReconnect([0,2e3,1e4,3e4]).build();I.current=H,P=H,H.on("ConnectionRequestReceived",K=>{console.log("📬 Connection request received:",K),X(),Z()}),H.on("ConnectionRequestSent",K=>{console.log("📤 Connection request sent:",K),oe(),Z()}),H.on("ConnectionAccepted",K=>{console.log("✅ Connection accepted:",K),U(),X(),oe(),Z()}),H.on("ConnectionRejected",K=>{console.log("❌ Connection rejected:",K),X(),oe(),Z()}),H.on("ConnectionRemoved",K=>{console.log("🗑️ Connection removed:",K),U(),Z()}),H.onreconnecting(()=>{console.log("🔄 SignalR reconnecting..."),m=!1}),H.onreconnected(()=>{console.log("🔄 SignalR reconnected!"),m=!0,U(),X(),Z(),oe()}),H.onclose(()=>{console.log("❌ SignalR connection closed"),m=!1});try{await H.start(),console.log("✅ SignalR Connected"),m=!0,await H.invoke("JoinUserGroup",j.toString()),console.log(`✅ Joined user group: User_${j}`)}catch(K){console.error("❌ SignalR connection error:",K),m=!1}})(),()=>{P&&(m&&P.invoke("LeaveUserGroup",j.toString()).catch(console.error),P.stop().catch(console.error),I.current=null)}},[j]);const xe=async m=>{try{const P=l.find(O=>O.id===m);await E.post(`${ne}/Connection/requests/${m}/accept`),F(`Connection request from ${P?.name||"user"} accepted!`)}catch(P){console.error("Error accepting request:",P),M("Failed to accept connection request")}},le=async m=>{try{const P=l.find(O=>O.id===m);await E.post(`${ne}/Connection/requests/${m}/reject`),F(`Connection request from ${P?.name||"user"} declined`)}catch(P){console.error("Error rejecting request:",P),M("Failed to reject connection request")}},ie=async m=>{try{console.log(`🗑️ Removing connection ${m}...`);const P=a.find(O=>O.id===m);await E.delete(`${ne}/Connection/${m}?userId=${j}`),console.log(`✅ Connection ${m} removed successfully`),F(`Connection with ${P?.name||"user"} removed`)}catch(P){console.error("❌ Error removing connection:",P),P.response?.status===404?M("Connection not found or already removed"):M("Failed to remove connection")}},de=async m=>{R(P=>new Set(P).add(m));try{const P=u.find(O=>O.id===m);await E.post(`${ne}/Connection/request`,{requesterId:j,receiverId:m}),F(`Connection request sent to ${P?.name||"user"}!`)}catch(P){R(O=>{const H=new Set(O);return H.delete(m),H}),console.error("Error sending connection request:",P),P.response?.data?.includes("already exists")?M("Connection already exists or request already sent"):M("Failed to send connection request")}},ae=m=>m.filter(P=>{const O=P.name?.toLowerCase().includes(t.toLowerCase()),H=o==="All Courses"||P.courses&&P.courses.includes(o);return O&&H}),w=ae(a),f=ae(u),v=l.filter(m=>m.name?.toLowerCase().includes(t.toLowerCase()));return n.jsxs("div",{className:"space-y-6",children:[n.jsx("div",{className:"fixed top-0 right-0 z-50 space-y-2 p-4",children:C.map(m=>n.jsx(Ge,{message:m.message,type:m.type,onClose:()=>T(m.id)},m.id))}),n.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:"Connections"}),n.jsx("div",{className:"border-b border-gray-200 dark:border-gray-700",children:n.jsx("nav",{className:"flex space-x-8",children:["connections","requests","discover"].map(m=>n.jsxs("button",{onClick:()=>e(m),className:`py-2 px-4 transition-colors duration-200 ${s===m?"border-b-2 border-blue-500 text-blue-600 dark:text-blue-400":"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300"}`,children:[m==="connections"?"My Connections":m==="requests"?"Requests":"Discover",m==="requests"&&l.length>0&&n.jsx("span",{className:"ml-2 bg-red-500 text-white text-xs px-2 py-1 rounded-full",children:l.length})]},m))})}),n.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[n.jsxs("div",{className:"flex-1 relative",children:[n.jsx(Xt,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 dark:text-gray-500",size:20}),n.jsx("input",{type:"text",placeholder:"Search connections...",value:t,onChange:m=>r(m.target.value),className:`w-full pl-10 pr-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg \r
                     bg-white dark:bg-gray-800 \r
                     text-gray-900 dark:text-gray-100 \r
                     placeholder-gray-500 dark:placeholder-gray-400\r
                     focus:ring-2 focus:ring-blue-500 focus:border-transparent \r
                     dark:focus:ring-blue-400 \r
                     transition-colors duration-200`})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Yt,{size:20,className:"text-gray-400 dark:text-gray-500"}),n.jsx("select",{value:o,onChange:m=>i(m.target.value),className:`border border-gray-300 dark:border-gray-600 rounded-lg px-3 py-2 \r
                     bg-white dark:bg-gray-800 \r
                     text-gray-900 dark:text-gray-100\r
                     focus:ring-2 focus:ring-blue-500 focus:border-transparent \r
                     dark:focus:ring-blue-400 \r
                     transition-colors duration-200`,children:p.map(m=>n.jsx("option",{value:m,className:"bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100",children:m},m))})]})]}),s==="connections"&&n.jsx(po,{connections:w,onRemove:ie,showError:M}),s==="requests"&&n.jsx(xo,{requests:v,onAccept:xe,onReject:le}),s==="discover"&&n.jsx(bo,{suggestions:f,onConnect:de,outgoingRequestIds:_})]})},po=({connections:s,onRemove:e,showError:t})=>{const r=async(o,i)=>{const a=JSON.parse(sessionStorage.getItem("currentUser")||"{}");try{const l=(await E.post(`${ne}/Chat/create`,{user1Id:a.id,user2Id:i})).data.chatId;setTimeout(()=>{window.location.href=`/chat?type=private&chatId=${l}`},100)}catch(c){console.error("Error starting chat:",c),t(`Failed to start chat: ${c.response?.data||c.message}`)}};return s.length?n.jsx("ul",{className:"space-y-4",children:s.map(o=>n.jsxs("li",{className:"flex items-center justify-between bg-white dark:bg-gray-800 p-4 rounded shadow-md dark:shadow-gray-700",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("img",{src:o.avatar||"/default-avatar.png",alt:o.name,className:"w-12 h-12 rounded-full object-cover"}),n.jsxs("div",{children:[n.jsx("div",{className:"font-semibold text-gray-900 dark:text-gray-100",children:o.name}),n.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:[o.major," • ",o.year]}),n.jsx("div",{className:"text-xs text-gray-400 dark:text-gray-500",children:o.courses?.join(", ")})]})]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsxs("button",{onClick:()=>{o.userId?r(o.id,o.userId):t("Cannot start chat: user ID is missing.")},className:"bg-green-500 hover:bg-green-600 text-white px-3 py-1 rounded flex items-center gap-1 transition-colors duration-200",children:[n.jsx(ce,{size:16})," Chat"]}),n.jsxs("button",{onClick:()=>e(o.id),className:"bg-red-500 hover:bg-red-600 text-white px-3 py-1 rounded flex items-center gap-1 transition-colors duration-200",children:[n.jsx(_e,{size:16})," Remove"]})]})]},o.id))}):n.jsx(bt,{message:"No connections found."})},xo=({requests:s,onAccept:e,onReject:t})=>s.length?n.jsx("ul",{className:"space-y-4",children:s.map(r=>n.jsxs("li",{className:"flex items-center justify-between bg-white dark:bg-gray-800 p-4 rounded shadow-md dark:shadow-gray-700",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("img",{src:r.avatar||"/default-avatar.png",alt:r.name,className:"w-12 h-12 rounded-full object-cover"}),n.jsxs("div",{children:[n.jsx("div",{className:"font-semibold text-gray-900 dark:text-gray-100",children:r.name}),n.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:[r.major," • ",r.year]}),n.jsx("div",{className:"text-xs text-gray-400 dark:text-gray-500",children:r.course})]})]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsxs("button",{onClick:()=>e(r.id),className:"bg-green-500 hover:bg-green-600 text-white px-3 py-1 rounded flex items-center gap-1 transition-colors duration-200",children:[n.jsx(Kt,{size:16})," Accept"]}),n.jsxs("button",{onClick:()=>t(r.id),className:"bg-red-500 hover:bg-red-600 text-white px-3 py-1 rounded flex items-center gap-1 transition-colors duration-200",children:[n.jsx(_e,{size:16})," Reject"]})]})]},r.id))}):n.jsx(bt,{message:"No pending requests."}),bo=({suggestions:s,onConnect:e,outgoingRequestIds:t})=>s.length?n.jsx("ul",{className:"space-y-4",children:s.map(r=>n.jsxs("li",{className:"flex items-center justify-between bg-white dark:bg-gray-800 p-4 rounded shadow-md dark:shadow-gray-700",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("img",{src:r.avatar||"/default-avatar.png",alt:r.name,className:"w-12 h-12 rounded-full object-cover"}),n.jsxs("div",{children:[n.jsx("div",{className:"font-semibold text-gray-900 dark:text-gray-100",children:r.name}),n.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:[r.major," • ",r.year]}),n.jsx("div",{className:"text-xs text-gray-400 dark:text-gray-500",children:r.courses?.join(", ")}),n.jsxs("div",{className:"text-xs text-blue-500 dark:text-blue-400",children:[r.mutualConnections," mutual connections"]})]})]}),t.has(r.id)?n.jsx("button",{disabled:!0,className:"bg-yellow-500 text-white px-3 py-1 rounded flex items-center gap-1 cursor-not-allowed",children:"Pending"}):n.jsxs("button",{onClick:()=>e(r.id),className:"bg-blue-500 hover:bg-blue-600 text-white px-3 py-1 rounded flex items-center gap-1 transition-colors duration-200",children:[n.jsx(qs,{size:16})," Connect"]})]},r.id))}):n.jsx(bt,{message:"No suggestions found."}),bt=({message:s})=>n.jsx("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:s});function yo(){const[s,e]=y.useState(!1),[t,r]=y.useState(null),o=()=>{e(!0)},i=()=>{e(!0)},a=()=>{e(!1),r(null),sessionStorage.removeItem("currentUser")};return y.useEffect(()=>{const c=sessionStorage.getItem("currentUser");c&&(r(JSON.parse(c)),e(!0))},[]),n.jsx(Js,{children:n.jsx(Is,{children:s?n.jsx(jn,{onLogout:a,children:n.jsxs(yt,{children:[n.jsx(ee,{path:"/",element:n.jsx(Nn,{})}),n.jsx(ee,{path:"/profile",element:n.jsx(En,{})}),n.jsx(ee,{path:"/courses",element:n.jsx(Rn,{})}),n.jsx(ee,{path:"/chat/:courseId",element:n.jsx(Ht,{})}),n.jsx(ee,{path:"/chat",element:n.jsx(Ht,{})}),n.jsx(ee,{path:"/connections",element:n.jsx(mo,{})}),n.jsx(ee,{path:"*",element:n.jsx(wt,{to:"/",replace:!0})})]})}):n.jsxs(yt,{children:[n.jsx(ee,{path:"/",element:n.jsx(go,{})}),n.jsx(ee,{path:"/login",element:n.jsx(ho,{onLogin:o})}),n.jsx(ee,{path:"/signup",element:n.jsx(fo,{onSignUp:i})}),n.jsx(ee,{path:"*",element:n.jsx(wt,{to:"/",replace:!0})})]})})})}const zt=document.getElementById("root");zt&&Ws.createRoot(zt).render(n.jsx(yo,{}));
